{"version":3,"file":"Control.Geocoder.modern.js","sources":["../src/geocoders/api.ts","../src/util.ts","../src/geocoders/arcgis.ts","../src/geocoders/bing.ts","../src/geocoders/google.ts","../src/geocoders/here.ts","../src/geocoders/latlng.ts","../src/geocoders/mapbox.ts","../src/geocoders/mapquest.ts","../src/geocoders/neutrino.ts","../src/geocoders/nominatim.ts","../src/geocoders/open-location-code.ts","../src/geocoders/opencage.ts","../src/geocoders/pelias.ts","../src/geocoders/photon.ts","../src/geocoders/what3words.ts","../src/control.ts","../src/index.ts"],"sourcesContent":["import * as L from 'leaflet';\r\n\r\n/**\r\n * An object that represents a result from a geocoding query\r\n */\r\nexport interface GeocodingResult {\r\n  /**\r\n   * Name of found location\r\n   */\r\n  name: string;\r\n  /**\r\n   * The bounds of the location\r\n   */\r\n  bbox: L.LatLngBounds;\r\n  /**\r\n   * The center coordinate of the location\r\n   */\r\n  center: L.LatLng;\r\n  /**\r\n   * URL for icon representing result; optional\r\n   */\r\n  icon?: string;\r\n  /**\r\n   * HTML formatted representation of the name\r\n   */\r\n  html?: string;\r\n  /**\r\n   * Additional properties returned by the geocoder\r\n   */\r\n  properties?: any;\r\n}\r\n\r\n/**\r\n * A callback function used in {@link IGeocoder.geocode} and {@link IGeocoder.suggest} and {@link IGeocoder.reverse}\r\n */\r\nexport type GeocodingCallback = (result: GeocodingResult[]) => void;\r\n\r\n/**\r\n * An interface implemented to respond to geocoding queries\r\n */\r\nexport interface IGeocoder {\r\n  /**\r\n   * Performs a geocoding query and returns the results to the callback in the provided context\r\n   * @param query the query\r\n   * @param cb the callback function\r\n   * @param context the `this` context in the callback\r\n   */\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void;\r\n  /**\r\n   * Performs a geocoding query suggestion (this happens while typing) and returns the results to the callback in the provided context\r\n   * @param query the query\r\n   * @param cb the callback function\r\n   * @param context the `this` context in the callback\r\n   */\r\n  suggest?(query: string, cb: GeocodingCallback, context?: any): void;\r\n  /**\r\n   * Performs a reverse geocoding query and returns the results to the callback in the provided context\r\n   * @param location the coordinate to reverse geocode\r\n   * @param scale the map scale possibly used for reverse geocoding\r\n   * @param cb the callback function\r\n   * @param context the `this` context in the callback\r\n   */\r\n  reverse?(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void;\r\n}\r\n\r\nexport interface GeocoderOptions {\r\n  /**\r\n   * URL of the service\r\n   */\r\n  serviceUrl: string;\r\n  /**\r\n   * Additional URL parameters (strings) that will be added to geocoding requests\r\n   */\r\n  geocodingQueryParams?: Record<string, unknown>;\r\n  /**\r\n   * Additional URL parameters (strings) that will be added to reverse geocoding requests\r\n   */\r\n  reverseQueryParams?: Record<string, unknown>;\r\n  /**\r\n   * API key to use this service\r\n   */\r\n  apiKey?: string;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function geocodingParams(\r\n  options: GeocoderOptions,\r\n  params: Record<string, unknown>\r\n): Record<string, unknown> {\r\n  return L.Util.extend(params, options.geocodingQueryParams);\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function reverseParams(\r\n  options: GeocoderOptions,\r\n  params: Record<string, unknown>\r\n): Record<string, unknown> {\r\n  return L.Util.extend(params, options.reverseQueryParams);\r\n}\r\n","import * as L from 'leaflet';\r\n/**\r\n * @internal\r\n */\r\nlet lastCallbackId = 0;\r\n\r\n// Adapted from handlebars.js\r\n// https://github.com/wycats/handlebars.js/\r\n/**\r\n * @internal\r\n */\r\nconst badChars = /[&<>\"'`]/g;\r\n/**\r\n * @internal\r\n */\r\nconst possible = /[&<>\"'`]/;\r\n/**\r\n * @internal\r\n */\r\nconst escape: Record<string, string> = {\r\n  '&': '&amp;',\r\n  '<': '&lt;',\r\n  '>': '&gt;',\r\n  '\"': '&quot;',\r\n  \"'\": '&#x27;',\r\n  '`': '&#x60;'\r\n};\r\n\r\n/**\r\n * @internal\r\n */\r\nfunction escapeChar(chr: string) {\r\n  return escape[chr];\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function htmlEscape(string?: string): string {\r\n  if (string == null) {\r\n    return '';\r\n  } else if (!string) {\r\n    return string + '';\r\n  }\r\n\r\n  // Force a string conversion as this will be done by the append regardless and\r\n  // the regex test will do this transparently behind the scenes, causing issues if\r\n  // an object's to string has escaped characters in it.\r\n  string = '' + string;\r\n\r\n  if (!possible.test(string)) {\r\n    return string;\r\n  }\r\n  return string.replace(badChars, escapeChar);\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function jsonp(\r\n  url: string,\r\n  params: Record<string, any>,\r\n  callback: (message: any) => void,\r\n  context: any,\r\n  jsonpParam?: string\r\n) {\r\n  const callbackId = '_l_geocoder_' + lastCallbackId++;\r\n  params[jsonpParam || 'callback'] = callbackId;\r\n  (window as any)[callbackId] = L.Util.bind(callback, context);\r\n  const script = document.createElement('script');\r\n  script.type = 'text/javascript';\r\n  script.src = url + getParamString(params);\r\n  script.id = callbackId;\r\n  document.getElementsByTagName('head')[0].appendChild(script);\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function getJSON(\r\n  url: string,\r\n  params: Record<string, unknown>,\r\n  callback: (message: any) => void\r\n): void {\r\n  const xmlHttp = new XMLHttpRequest();\r\n  xmlHttp.onreadystatechange = function() {\r\n    if (xmlHttp.readyState !== 4) {\r\n      return;\r\n    }\r\n    let message;\r\n    if (xmlHttp.status !== 200 && xmlHttp.status !== 304) {\r\n      message = '';\r\n    } else if (typeof xmlHttp.response === 'string') {\r\n      // IE doesn't parse JSON responses even with responseType: 'json'.\r\n      try {\r\n        message = JSON.parse(xmlHttp.response);\r\n      } catch (e) {\r\n        // Not a JSON response\r\n        message = xmlHttp.response;\r\n      }\r\n    } else {\r\n      message = xmlHttp.response;\r\n    }\r\n    callback(message);\r\n  };\r\n  xmlHttp.open('GET', url + getParamString(params), true);\r\n  xmlHttp.responseType = 'json';\r\n  xmlHttp.setRequestHeader('Accept', 'application/json');\r\n  xmlHttp.send(null);\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function template(str: string, data: Record<string, any>): string {\r\n  return str.replace(/\\{ *([\\w_]+) *\\}/g, (str, key) => {\r\n    let value = data[key];\r\n    if (value === undefined) {\r\n      value = '';\r\n    } else if (typeof value === 'function') {\r\n      value = value(data);\r\n    }\r\n    return htmlEscape(value);\r\n  });\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function getParamString(\r\n  obj: Record<string, unknown | unknown[]>,\r\n  existingUrl?: string,\r\n  uppercase?: boolean\r\n): string {\r\n  const params = [];\r\n  for (const i in obj) {\r\n    const key = encodeURIComponent(uppercase ? i.toUpperCase() : i);\r\n    const value = obj[i];\r\n    if (!Array.isArray(value)) {\r\n      params.push(key + '=' + encodeURIComponent(String(value)));\r\n    } else {\r\n      for (let j = 0; j < value.length; j++) {\r\n        params.push(key + '=' + encodeURIComponent(value[j]));\r\n      }\r\n    }\r\n  }\r\n  return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface ArcGisOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [ArcGIS geocoder](https://developers.arcgis.com/features/geocoding/)\r\n */\r\nexport class ArcGis implements IGeocoder {\r\n  options: ArcGisOptions = {\r\n    serviceUrl: 'https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer',\r\n    apiKey: ''\r\n  };\r\n\r\n  constructor(options?: Partial<ArcGisOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      token: this.options.apiKey,\r\n      SingleLine: query,\r\n      outFields: 'Addr_Type',\r\n      forStorage: false,\r\n      maxLocations: 10,\r\n      f: 'json'\r\n    });\r\n\r\n    getJSON(this.options.serviceUrl + '/findAddressCandidates', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.candidates && data.candidates.length) {\r\n        for (let i = 0; i <= data.candidates.length - 1; i++) {\r\n          const loc = data.candidates[i];\r\n          const latLng = L.latLng(loc.location.y, loc.location.x);\r\n          const latLngBounds = L.latLngBounds(\r\n            L.latLng(loc.extent.ymax, loc.extent.xmax),\r\n            L.latLng(loc.extent.ymin, loc.extent.xmin)\r\n          );\r\n          results[i] = {\r\n            name: loc.address,\r\n            bbox: latLngBounds,\r\n            center: latLng\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      location: location.lng + ',' + location.lat,\r\n      distance: 100,\r\n      f: 'json'\r\n    });\r\n    getJSON(this.options.serviceUrl + '/reverseGeocode', params, data => {\r\n      const result: GeocodingResult[] = [];\r\n      if (data && !data.error) {\r\n        const center = L.latLng(data.location.y, data.location.x);\r\n        const bbox = L.latLngBounds(center, center);\r\n        result.push({\r\n          name: data.address.Match_addr,\r\n          center: center,\r\n          bbox: bbox\r\n        });\r\n      }\r\n\r\n      cb.call(context, result);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link ArcGis}\r\n * @param options the options\r\n */\r\nexport function arcgis(options?: Partial<ArcGisOptions>) {\r\n  return new ArcGis(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { jsonp } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface BingOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [Bing Locations API](https://docs.microsoft.com/en-us/bingmaps/rest-services/locations/)\r\n */\r\nexport class Bing implements IGeocoder {\r\n  options: BingOptions = {\r\n    serviceUrl: 'https://dev.virtualearth.net/REST/v1/Locations'\r\n  };\r\n\r\n  constructor(options?: Partial<BingOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      query: query,\r\n      key: this.options.apiKey\r\n    });\r\n    jsonp(\r\n      this.options.apiKey,\r\n      params,\r\n      data => {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.resourceSets.length > 0) {\r\n          for (let i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\r\n            const resource = data.resourceSets[0].resources[i],\r\n              bbox = resource.bbox;\r\n            results[i] = {\r\n              name: resource.name,\r\n              bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\r\n              center: L.latLng(resource.point.coordinates)\r\n            };\r\n          }\r\n        }\r\n        cb.call(context, results);\r\n      },\r\n      this,\r\n      'jsonp'\r\n    );\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      key: this.options.apiKey\r\n    });\r\n    jsonp(\r\n      this.options.serviceUrl + location.lat + ',' + location.lng,\r\n      params,\r\n      data => {\r\n        const results: GeocodingResult[] = [];\r\n        for (let i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\r\n          const resource = data.resourceSets[0].resources[i],\r\n            bbox = resource.bbox;\r\n          results[i] = {\r\n            name: resource.name,\r\n            bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\r\n            center: L.latLng(resource.point.coordinates)\r\n          };\r\n        }\r\n        cb.call(context, results);\r\n      },\r\n      this,\r\n      'jsonp'\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Bing}\r\n * @param options the options\r\n */\r\nexport function bing(options?: Partial<BingOptions>) {\r\n  return new Bing(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\n/**\r\n * Implementation of the [Google Geocoding API](https://developers.google.com/maps/documentation/geocoding/)\r\n */\r\nexport interface GoogleOptions extends GeocoderOptions {}\r\n\r\nexport class Google implements IGeocoder {\r\n  options: GoogleOptions = {\r\n    serviceUrl: 'https://maps.googleapis.com/maps/api/geocode/json'\r\n  };\r\n\r\n  constructor(options?: Partial<GoogleOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      key: this.options.apiKey,\r\n      address: query\r\n    });\r\n    getJSON(this.options.serviceUrl, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.results && data.results.length) {\r\n        for (let i = 0; i <= data.results.length - 1; i++) {\r\n          const loc = data.results[i];\r\n          const latLng = L.latLng(loc.geometry.location);\r\n          const latLngBounds = L.latLngBounds(\r\n            L.latLng(loc.geometry.viewport.northeast),\r\n            L.latLng(loc.geometry.viewport.southwest)\r\n          );\r\n          results[i] = {\r\n            name: loc.formatted_address,\r\n            bbox: latLngBounds,\r\n            center: latLng,\r\n            properties: loc.address_components\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      key: this.options.apiKey,\r\n      latlng: location.lat + ',' + location.lng\r\n    });\r\n    getJSON(this.options.serviceUrl, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.results && data.results.length) {\r\n        for (let i = 0; i <= data.results.length - 1; i++) {\r\n          const loc = data.results[i];\r\n          const center = L.latLng(loc.geometry.location);\r\n          const bbox = L.latLngBounds(\r\n            L.latLng(loc.geometry.viewport.northeast),\r\n            L.latLng(loc.geometry.viewport.southwest)\r\n          );\r\n          results[i] = {\r\n            name: loc.formatted_address,\r\n            bbox: bbox,\r\n            center: center,\r\n            properties: loc.address_components\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Google}\r\n * @param options the options\r\n */\r\nexport function google(options?: Partial<GoogleOptions>) {\r\n  return new Google(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface HereOptions extends GeocoderOptions {\r\n  /**\r\n   * Use `apiKey` and the new `HEREv2` geocoder\r\n   * @deprecated\r\n   */\r\n  app_id: string;\r\n  /**\r\n   * Use `apiKey` and the new `HEREv2` geocoder\r\n   * @deprecated\r\n   */\r\n  app_code: string;\r\n  reverseGeocodeProxRadius?: any;\r\n  apiKey: string;\r\n}\r\n\r\n/**\r\n * Implementation of the [HERE Geocoder API](https://developer.here.com/documentation/geocoder/topics/introduction.html)\r\n */\r\nexport class HERE implements IGeocoder {\r\n  options: HereOptions = {\r\n    serviceUrl: 'https://geocoder.api.here.com/6.2/',\r\n    app_id: '',\r\n    app_code: '',\r\n    apiKey: ''\r\n  };\r\n\r\n  constructor(options?: Partial<HereOptions>) {\r\n    L.Util.setOptions(this, options);\r\n    if (options.apiKey) throw Error('apiKey is not supported, use app_id/app_code instead!');\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      searchtext: query,\r\n      gen: 9,\r\n      app_id: this.options.app_id,\r\n      app_code: this.options.app_code,\r\n      jsonattributes: 1\r\n    });\r\n    this.getJSON(this.options.serviceUrl + 'geocode.json', params, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    let prox = location.lat + ',' + location.lng;\r\n    if (this.options.reverseGeocodeProxRadius) {\r\n      prox += ',' + this.options.reverseGeocodeProxRadius;\r\n    }\r\n    const params = reverseParams(this.options, {\r\n      prox,\r\n      mode: 'retrieveAddresses',\r\n      app_id: this.options.app_id,\r\n      app_code: this.options.app_code,\r\n      gen: 9,\r\n      jsonattributes: 1\r\n    });\r\n    this.getJSON(this.options.serviceUrl + 'reversegeocode.json', params, cb, context);\r\n  }\r\n\r\n  getJSON(url: string, params: any, cb: GeocodingCallback, context?: any) {\r\n    getJSON(url, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.response.view && data.response.view.length) {\r\n        for (let i = 0; i <= data.response.view[0].result.length - 1; i++) {\r\n          const loc = data.response.view[0].result[i].location;\r\n          const center = L.latLng(loc.displayPosition.latitude, loc.displayPosition.longitude);\r\n          const bbox = L.latLngBounds(\r\n            L.latLng(loc.mapView.topLeft.latitude, loc.mapView.topLeft.longitude),\r\n            L.latLng(loc.mapView.bottomRight.latitude, loc.mapView.bottomRight.longitude)\r\n          );\r\n          results[i] = {\r\n            name: loc.address.label,\r\n            properties: loc.address,\r\n            bbox: bbox,\r\n            center: center\r\n          };\r\n        }\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Implementation of the new [HERE Geocoder API](https://developer.here.com/documentation/geocoding-search-api/api-reference-swagger.html)\r\n */\r\nexport class HEREv2 implements IGeocoder {\r\n  options: HereOptions = {\r\n    serviceUrl: 'https://geocode.search.hereapi.com/v1',\r\n    apiKey: '',\r\n    app_id: '',\r\n    app_code: ''\r\n  };\r\n\r\n  constructor(options?: Partial<HereOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      q: query,\r\n      apiKey: this.options.apiKey\r\n    });\r\n\r\n    if (!params.at && !params.in) {\r\n      throw Error(\r\n        'at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.'\r\n      );\r\n    }\r\n\r\n    this.getJSON(this.options.serviceUrl + '/discover', params, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      at: location.lat + ',' + location.lng,\r\n      limit: this.options.reverseGeocodeProxRadius,\r\n      apiKey: this.options.apiKey\r\n    });\r\n    this.getJSON(this.options.serviceUrl + '/revgeocode', params, cb, context);\r\n  }\r\n\r\n  getJSON(url: string, params: any, cb: GeocodingCallback, context?: any) {\r\n    getJSON(url, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n\r\n      if (data.items && data.items.length) {\r\n        for (let i = 0; i <= data.items.length - 1; i++) {\r\n          const item = data.items[i];\r\n          const latLng = L.latLng(item.position.lat, item.position.lng);\r\n          let bbox: L.LatLngBounds;\r\n          if (item.mapView) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(item.mapView.south, item.mapView.west),\r\n              L.latLng(item.mapView.north, item.mapView.east)\r\n            );\r\n          } else {\r\n            // Using only position when not provided\r\n            bbox = L.latLngBounds(\r\n              L.latLng(item.position.lat, item.position.lng),\r\n              L.latLng(item.position.lat, item.position.lng)\r\n            );\r\n          }\r\n          results[i] = {\r\n            name: item.address.label,\r\n            properties: item.address,\r\n            bbox: bbox,\r\n            center: latLng\r\n          };\r\n        }\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link HERE}\r\n * @param options the options\r\n */\r\nexport function here(options?: Partial<HereOptions>) {\r\n  if (options.apiKey) {\r\n    return new HEREv2(options);\r\n  } else {\r\n    return new HERE(options);\r\n  }\r\n}\r\n","import * as L from 'leaflet';\r\nimport { IGeocoder, GeocodingCallback, GeocodingResult } from './api';\r\n\r\nexport interface LatLngOptions {\r\n  /**\r\n   * The next geocoder to use for non-supported queries\r\n   */\r\n  next?: IGeocoder;\r\n  /**\r\n   * The size in meters used for passing to `LatLng.toBounds`\r\n   */\r\n  sizeInMeters: number;\r\n}\r\n\r\n/**\r\n * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\r\n * @param query the latitude/longitude string to parse\r\n * @returns the parsed latitude/longitude\r\n */\r\nexport function parseLatLng(query: string): L.LatLng | undefined {\r\n  let match;\r\n  // regex from https://github.com/openstreetmap/openstreetmap-website/blob/master/app/controllers/geocoder_controller.rb\r\n  if ((match = query.match(/^([NS])\\s*(\\d{1,3}(?:\\.\\d*)?)\\W*([EW])\\s*(\\d{1,3}(?:\\.\\d*)?)$/))) {\r\n    // [NSEW] decimal degrees\r\n    return L.latLng(\r\n      (/N/i.test(match[1]) ? 1 : -1) * +match[2],\r\n      (/E/i.test(match[3]) ? 1 : -1) * +match[4]\r\n    );\r\n  } else if (\r\n    (match = query.match(/^(\\d{1,3}(?:\\.\\d*)?)\\s*([NS])\\W*(\\d{1,3}(?:\\.\\d*)?)\\s*([EW])$/))\r\n  ) {\r\n    // decimal degrees [NSEW]\r\n    return L.latLng(\r\n      (/N/i.test(match[2]) ? 1 : -1) * +match[1],\r\n      (/E/i.test(match[4]) ? 1 : -1) * +match[3]\r\n    );\r\n  } else if (\r\n    (match = query.match(\r\n      /^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?$/\r\n    ))\r\n  ) {\r\n    // [NSEW] degrees, decimal minutes\r\n    return L.latLng(\r\n      (/N/i.test(match[1]) ? 1 : -1) * (+match[2] + +match[3] / 60),\r\n      (/E/i.test(match[4]) ? 1 : -1) * (+match[5] + +match[6] / 60)\r\n    );\r\n  } else if (\r\n    (match = query.match(\r\n      /^(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([EW])$/\r\n    ))\r\n  ) {\r\n    // degrees, decimal minutes [NSEW]\r\n    return L.latLng(\r\n      (/N/i.test(match[3]) ? 1 : -1) * (+match[1] + +match[2] / 60),\r\n      (/E/i.test(match[6]) ? 1 : -1) * (+match[4] + +match[5] / 60)\r\n    );\r\n  } else if (\r\n    (match = query.match(\r\n      /^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?$/\r\n    ))\r\n  ) {\r\n    // [NSEW] degrees, minutes, decimal seconds\r\n    return L.latLng(\r\n      (/N/i.test(match[1]) ? 1 : -1) * (+match[2] + +match[3] / 60 + +match[4] / 3600),\r\n      (/E/i.test(match[5]) ? 1 : -1) * (+match[6] + +match[7] / 60 + +match[8] / 3600)\r\n    );\r\n  } else if (\r\n    (match = query.match(\r\n      /^(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\s*([EW])$/\r\n    ))\r\n  ) {\r\n    // degrees, minutes, decimal seconds [NSEW]\r\n    return L.latLng(\r\n      (/N/i.test(match[4]) ? 1 : -1) * (+match[1] + +match[2] / 60 + +match[3] / 3600),\r\n      (/E/i.test(match[8]) ? 1 : -1) * (+match[5] + +match[6] / 60 + +match[7] / 3600)\r\n    );\r\n  } else if ((match = query.match(/^\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*[\\s,]\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*$/))) {\r\n    return L.latLng(+match[1], +match[2]);\r\n  }\r\n}\r\n\r\n/**\r\n * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\r\n */\r\nexport class LatLng implements IGeocoder {\r\n  options: LatLngOptions = {\r\n    next: undefined,\r\n    sizeInMeters: 10000\r\n  };\r\n\r\n  constructor(options?: Partial<LatLngOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\r\n    const center = parseLatLng(query);\r\n    if (center) {\r\n      const results: GeocodingResult[] = [\r\n        {\r\n          name: query,\r\n          center: center,\r\n          bbox: center.toBounds(this.options.sizeInMeters)\r\n        }\r\n      ];\r\n      cb.call(context, results);\r\n    } else if (this.options.next) {\r\n      this.options.next.geocode(query, cb, context);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link LatLng}\r\n * @param options the options\r\n */\r\nexport function latLng(options?: Partial<LatLngOptions>) {\r\n  return new LatLng(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface MapboxOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [Mapbox Geocoding](https://www.mapbox.com/api-documentation/#geocoding)\r\n */\r\nexport class Mapbox implements IGeocoder {\r\n  options: MapboxOptions = {\r\n    serviceUrl: 'https://api.mapbox.com/geocoding/v5/mapbox.places/'\r\n  };\r\n\r\n  constructor(options?: Partial<MapboxOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  _getProperties(loc) {\r\n    const properties = {\r\n      text: loc.text,\r\n      address: loc.address\r\n    };\r\n\r\n    for (let j = 0; j < (loc.context || []).length; j++) {\r\n      const id = loc.context[j].id.split('.')[0];\r\n      properties[id] = loc.context[j].text;\r\n\r\n      // Get country code when available\r\n      if (loc.context[j].short_code) {\r\n        properties['countryShortCode'] = loc.context[j].short_code;\r\n      }\r\n    }\r\n    return properties;\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params: any = geocodingParams(this.options, {\r\n      access_token: this.options.apiKey\r\n    });\r\n    if (\r\n      params.proximity !== undefined &&\r\n      params.proximity.lat !== undefined &&\r\n      params.proximity.lng !== undefined\r\n    ) {\r\n      params.proximity = params.proximity.lng + ',' + params.proximity.lat;\r\n    }\r\n    getJSON(this.options.serviceUrl + encodeURIComponent(query) + '.json', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.features && data.features.length) {\r\n        for (let i = 0; i <= data.features.length - 1; i++) {\r\n          const loc = data.features[i];\r\n          const center = L.latLng(loc.center.reverse());\r\n          let bbox: L.LatLngBounds;\r\n          if (loc.bbox) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(loc.bbox.slice(0, 2).reverse()),\r\n              L.latLng(loc.bbox.slice(2, 4).reverse())\r\n            );\r\n          } else {\r\n            bbox = L.latLngBounds(center, center);\r\n          }\r\n\r\n          results[i] = {\r\n            name: loc.place_name,\r\n            bbox: bbox,\r\n            center: center,\r\n            properties: this._getProperties(loc)\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const url = this.options.serviceUrl + location.lng + ',' + location.lat + '.json';\r\n    const param = reverseParams(this.options, {\r\n      access_token: this.options.apiKey\r\n    });\r\n    getJSON(url, param, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.features && data.features.length) {\r\n        for (let i = 0; i <= data.features.length - 1; i++) {\r\n          const loc = data.features[i];\r\n          const center = L.latLng(loc.center.reverse());\r\n          let bbox: L.LatLngBounds;\r\n          if (loc.bbox) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(loc.bbox.slice(0, 2).reverse()),\r\n              L.latLng(loc.bbox.slice(2, 4).reverse())\r\n            );\r\n          } else {\r\n            bbox = L.latLngBounds(center, center);\r\n          }\r\n          results[i] = {\r\n            name: loc.place_name,\r\n            bbox: bbox,\r\n            center: center,\r\n            properties: this._getProperties(loc)\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Mapbox}\r\n * @param options the options\r\n */\r\nexport function mapbox(options?: Partial<MapboxOptions>) {\r\n  return new Mapbox(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface MapQuestOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [MapQuest Geocoding API](http://developer.mapquest.com/web/products/dev-services/geocoding-ws)\r\n */\r\nexport class MapQuest implements IGeocoder {\r\n  options: MapQuestOptions = {\r\n    serviceUrl: 'https://www.mapquestapi.com/geocoding/v1'\r\n  };\r\n\r\n  constructor(options?: Partial<MapQuestOptions>) {\r\n    L.Util.setOptions(this, options);\r\n    // MapQuest seems to provide URI encoded API keys,\r\n    // so to avoid encoding them twice, we decode them here\r\n    this.options.apiKey = decodeURIComponent(this.options.apiKey);\r\n  }\r\n\r\n  _formatName(...parts: string[]) {\r\n    return parts.filter(s => !!s).join(', ');\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      key: this.options.apiKey,\r\n      location: query,\r\n      limit: 5,\r\n      outFormat: 'json'\r\n    });\r\n    getJSON(\r\n      this.options.serviceUrl + '/address',\r\n      params,\r\n      L.Util.bind(function(data) {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.results && data.results[0].locations) {\r\n          for (let i = data.results[0].locations.length - 1; i >= 0; i--) {\r\n            const loc = data.results[0].locations[i];\r\n            const center = L.latLng(loc.latLng);\r\n            results[i] = {\r\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\r\n              bbox: L.latLngBounds(center, center),\r\n              center: center\r\n            };\r\n          }\r\n        }\r\n\r\n        cb.call(context, results);\r\n      }, this)\r\n    );\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      key: this.options.apiKey,\r\n      location: location.lat + ',' + location.lng,\r\n      outputFormat: 'json'\r\n    });\r\n    getJSON(\r\n      this.options.serviceUrl + '/reverse',\r\n      params,\r\n      L.Util.bind(function(data) {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.results && data.results[0].locations) {\r\n          for (let i = data.results[0].locations.length - 1; i >= 0; i--) {\r\n            const loc = data.results[0].locations[i];\r\n            const center = L.latLng(loc.latLng);\r\n            results[i] = {\r\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\r\n              bbox: L.latLngBounds(center, center),\r\n              center: center\r\n            };\r\n          }\r\n        }\r\n\r\n        cb.call(context, results);\r\n      }, this)\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link MapQuest}\r\n * @param options the options\r\n */\r\nexport function mapQuest(options?: Partial<MapQuestOptions>) {\r\n  return new MapQuest(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface NeutrinoOptions extends GeocoderOptions {\r\n  userId: string;\r\n}\r\n\r\n/**\r\n * Implementation of the [Neutrino API](https://www.neutrinoapi.com/api/geocode-address/)\r\n */\r\nexport class Neutrino implements IGeocoder {\r\n  options: NeutrinoOptions = {\r\n    userId: undefined,\r\n    apiKey: undefined,\r\n    serviceUrl: 'https://neutrinoapi.com/'\r\n  };\r\n\r\n  constructor(options?: Partial<NeutrinoOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  // https://www.neutrinoapi.com/api/geocode-address/\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      apiKey: this.options.apiKey,\r\n      userId: this.options.userId,\r\n      //get three words and make a dot based string\r\n      address: query.split(/\\s+/).join('.')\r\n    });\r\n    getJSON(this.options.serviceUrl + 'geocode-address', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.locations) {\r\n        data.geometry = data.locations[0];\r\n        const center = L.latLng(data.geometry['latitude'], data.geometry['longitude']);\r\n        const bbox = L.latLngBounds(center, center);\r\n        results[0] = {\r\n          name: data.geometry.address,\r\n          bbox: bbox,\r\n          center: center\r\n        };\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  // https://www.neutrinoapi.com/api/geocode-reverse/\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      apiKey: this.options.apiKey,\r\n      userId: this.options.userId,\r\n      latitude: location.lat,\r\n      longitude: location.lng\r\n    });\r\n    getJSON(this.options.serviceUrl + 'geocode-reverse', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.status.status == 200 && data.found) {\r\n        const center = L.latLng(location.lat, location.lng);\r\n        const bbox = L.latLngBounds(center, center);\r\n        results[0] = {\r\n          name: data.address,\r\n          bbox: bbox,\r\n          center: center\r\n        };\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Neutrino}\r\n * @param options the options\r\n */\r\nexport function neutrino(options?: Partial<NeutrinoOptions>) {\r\n  return new Neutrino(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { template, getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface NominatimResult {\r\n  place_id: number;\r\n  licence: string;\r\n  osm_type: string;\r\n  osm_id: number;\r\n  boundingbox: string[];\r\n  lat: string;\r\n  lon: string;\r\n  display_name: string;\r\n  class: string;\r\n  type: string;\r\n  importance: number;\r\n  icon?: string;\r\n  address: NominatimAddress;\r\n}\r\n\r\nexport interface NominatimAddress {\r\n  building?: string;\r\n  city_district?: string;\r\n  city?: string;\r\n  country_code?: string;\r\n  country?: string;\r\n  county?: string;\r\n  hamlet?: string;\r\n  house_number?: string;\r\n  neighbourhood?: string;\r\n  postcode?: string;\r\n  road?: string;\r\n  state_district?: string;\r\n  state?: string;\r\n  suburb?: string;\r\n  village?: string;\r\n}\r\n\r\nexport interface NominatimOptions extends GeocoderOptions {\r\n  /**\r\n   * Additional URL parameters (strings) that will be added to geocoding requests; can be used to restrict results to a specific country for example, by providing the [`countrycodes`](https://wiki.openstreetmap.org/wiki/Nominatim#Parameters) parameter to Nominatim\r\n   */\r\n  geocodingQueryParams?: Record<string, unknown>;\r\n  /**\r\n   * A function that takes an GeocodingResult as argument and returns an HTML formatted string that represents the result. Default function breaks up address in parts from most to least specific, in attempt to increase readability compared to Nominatim's naming\r\n   */\r\n  htmlTemplate: (r: NominatimResult) => string;\r\n}\r\n\r\n/**\r\n * Implementation of the [Nominatim](https://wiki.openstreetmap.org/wiki/Nominatim) geocoder.\r\n *\r\n * This is the default geocoding service used by the control, unless otherwise specified in the options.\r\n *\r\n * Unless using your own Nominatim installation, please refer to the [Nominatim usage policy](https://operations.osmfoundation.org/policies/nominatim/).\r\n */\r\nexport class Nominatim implements IGeocoder {\r\n  options: NominatimOptions = {\r\n    serviceUrl: 'https://nominatim.openstreetmap.org/',\r\n    htmlTemplate: function(r: NominatimResult) {\r\n      const address = r.address;\r\n      let className: string;\r\n      const parts = [];\r\n      if (address.road || address.building) {\r\n        parts.push('{building} {road} {house_number}');\r\n      }\r\n\r\n      if (address.city || (address as any).town || address.village || address.hamlet) {\r\n        className = parts.length > 0 ? 'leaflet-control-geocoder-address-detail' : '';\r\n        parts.push(\r\n          '<span class=\"' + className + '\">{postcode} {city} {town} {village} {hamlet}</span>'\r\n        );\r\n      }\r\n\r\n      if (address.state || address.country) {\r\n        className = parts.length > 0 ? 'leaflet-control-geocoder-address-context' : '';\r\n        parts.push('<span class=\"' + className + '\">{state} {country}</span>');\r\n      }\r\n\r\n      return template(parts.join('<br/>'), address);\r\n    }\r\n  };\r\n\r\n  constructor(options?: Partial<NominatimOptions>) {\r\n    L.Util.setOptions(this, options || {});\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\r\n    const params = geocodingParams(this.options, {\r\n      q: query,\r\n      limit: 5,\r\n      format: 'json',\r\n      addressdetails: 1\r\n    });\r\n    getJSON(this.options.serviceUrl + 'search', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      for (let i = data.length - 1; i >= 0; i--) {\r\n        const bbox = data[i].boundingbox;\r\n        for (let j = 0; j < 4; j++) bbox[j] = +bbox[j];\r\n        results[i] = {\r\n          icon: data[i].icon,\r\n          name: data[i].display_name,\r\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(data[i]) : undefined,\r\n          bbox: L.latLngBounds([bbox[0], bbox[2]], [bbox[1], bbox[3]]),\r\n          center: L.latLng(data[i].lat, data[i].lon),\r\n          properties: data[i]\r\n        };\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any) {\r\n    const params = reverseParams(this.options, {\r\n      lat: location.lat,\r\n      lon: location.lng,\r\n      zoom: Math.round(Math.log(scale / 256) / Math.log(2)),\r\n      addressdetails: 1,\r\n      format: 'json'\r\n    });\r\n    getJSON(this.options.serviceUrl + 'reverse', params, data => {\r\n      const result: GeocodingResult[] = [];\r\n      if (data && data.lat && data.lon) {\r\n        const center = L.latLng(data.lat, data.lon);\r\n        const bbox = L.latLngBounds(center, center);\r\n        result.push({\r\n          name: data.display_name,\r\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(data) : undefined,\r\n          center: center,\r\n          bbox: bbox,\r\n          properties: data\r\n        });\r\n      }\r\n      cb.call(context, result);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Nominatim}\r\n * @param options the options\r\n */\r\nexport function nominatim(options?: Partial<NominatimOptions>) {\r\n  return new Nominatim(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { IGeocoder, GeocodingCallback, GeocodingResult } from './api';\r\n\r\nexport interface OpenLocationCodeOptions {\r\n  OpenLocationCode: OpenLocationCodeApi;\r\n  codeLength?: number;\r\n}\r\n\r\nexport interface OpenLocationCodeApi {\r\n  encode(latitude: number, longitude: number, codeLength?: number): string;\r\n  decode(code: string): CodeArea;\r\n}\r\n\r\nexport interface CodeArea {\r\n  latitudeLo: number;\r\n  longitudeLo: number;\r\n  latitudeHi: number;\r\n  longitudeHi: number;\r\n  latitudeCenter: number;\r\n  longitudeCenter: number;\r\n  codeLength: number;\r\n}\r\n\r\n/**\r\n * Implementation of the [Plus codes](https://plus.codes/) (formerly OpenLocationCode) (requires [open-location-code](https://www.npmjs.com/package/open-location-code))\r\n */\r\nexport class OpenLocationCode implements IGeocoder {\r\n  options: OpenLocationCodeOptions;\r\n  constructor(options?: Partial<OpenLocationCodeOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\r\n    try {\r\n      const decoded = this.options.OpenLocationCode.decode(query);\r\n      const result: GeocodingResult = {\r\n        name: query,\r\n        center: L.latLng(decoded.latitudeCenter, decoded.longitudeCenter),\r\n        bbox: L.latLngBounds(\r\n          L.latLng(decoded.latitudeLo, decoded.longitudeLo),\r\n          L.latLng(decoded.latitudeHi, decoded.longitudeHi)\r\n        )\r\n      };\r\n      cb.call(context, [result]);\r\n    } catch (e) {\r\n      console.warn(e); // eslint-disable-line no-console\r\n      cb.call(context, []);\r\n    }\r\n  }\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any) {\r\n    try {\r\n      const code = this.options.OpenLocationCode.encode(\r\n        location.lat,\r\n        location.lng,\r\n        this.options.codeLength\r\n      );\r\n      const result = {\r\n        name: code,\r\n        center: L.latLng(location.lat, location.lng),\r\n        bbox: L.latLngBounds(\r\n          L.latLng(location.lat, location.lng),\r\n          L.latLng(location.lat, location.lng)\r\n        )\r\n      };\r\n      cb.call(context, [result]);\r\n    } catch (e) {\r\n      console.warn(e); // eslint-disable-line no-console\r\n      cb.call(context, []);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link OpenLocationCode}\r\n * @param options the options\r\n */\r\nexport function openLocationCode(options?: Partial<OpenLocationCodeOptions>) {\r\n  return new OpenLocationCode(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface OpenCageOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [OpenCage Data API](https://opencagedata.com/)\r\n */\r\nexport class OpenCage implements IGeocoder {\r\n  options: OpenCageOptions = {\r\n    serviceUrl: 'https://api.opencagedata.com/geocode/v1/json'\r\n  };\r\n\r\n  constructor(options?: Partial<OpenCageOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      key: this.options.apiKey,\r\n      q: query\r\n    });\r\n    getJSON(this.options.serviceUrl, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.results && data.results.length) {\r\n        for (let i = 0; i < data.results.length; i++) {\r\n          const loc = data.results[i];\r\n          const center = L.latLng(loc.geometry);\r\n          let bbox: L.LatLngBounds;\r\n          if (loc.annotations && loc.annotations.bounds) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(loc.annotations.bounds.northeast),\r\n              L.latLng(loc.annotations.bounds.southwest)\r\n            );\r\n          } else {\r\n            bbox = L.latLngBounds(center, center);\r\n          }\r\n          results.push({\r\n            name: loc.formatted,\r\n            bbox: bbox,\r\n            center: center\r\n          });\r\n        }\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      key: this.options.apiKey,\r\n      q: [location.lat, location.lng].join(',')\r\n    });\r\n    getJSON(this.options.serviceUrl, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.results && data.results.length) {\r\n        for (let i = 0; i < data.results.length; i++) {\r\n          const loc = data.results[i];\r\n          const center = L.latLng(loc.geometry);\r\n          let bbox: L.LatLngBounds;\r\n          if (loc.annotations && loc.annotations.bounds) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(loc.annotations.bounds.northeast),\r\n              L.latLng(loc.annotations.bounds.southwest)\r\n            );\r\n          } else {\r\n            bbox = L.latLngBounds(center, center);\r\n          }\r\n          results.push({\r\n            name: loc.formatted,\r\n            bbox: bbox,\r\n            center: center\r\n          });\r\n        }\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\nexport function opencage(options?: Partial<OpenCageOptions>) {\r\n  return new OpenCage(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface PeliasOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [Pelias](https://pelias.io/), [geocode.earth](https://geocode.earth/) geocoder (formerly Mapzen Search)\r\n */\r\nexport class Pelias implements IGeocoder {\r\n  options: PeliasOptions = {\r\n    serviceUrl: 'https://api.geocode.earth/v1'\r\n  };\r\n\r\n  private _lastSuggest = 0;\r\n\r\n  constructor(options?: Partial<PeliasOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      api_key: this.options.apiKey,\r\n      text: query\r\n    });\r\n    getJSON(this.options.serviceUrl + '/search', params, data => {\r\n      cb.call(context, this._parseResults(data, 'bbox'));\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      api_key: this.options.apiKey,\r\n      text: query\r\n    });\r\n    getJSON(this.options.serviceUrl + '/autocomplete', params, data => {\r\n      if (data.geocoding.timestamp > this._lastSuggest) {\r\n        this._lastSuggest = data.geocoding.timestamp;\r\n        cb.call(context, this._parseResults(data, 'bbox'));\r\n      }\r\n    });\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      api_key: this.options.apiKey,\r\n      'point.lat': location.lat,\r\n      'point.lon': location.lng\r\n    });\r\n    getJSON(this.options.serviceUrl + '/reverse', params, data => {\r\n      cb.call(context, this._parseResults(data, 'bounds'));\r\n    });\r\n  }\r\n\r\n  _parseResults(data, bboxname) {\r\n    const results: GeocodingResult[] = [];\r\n    L.geoJSON(data, {\r\n      pointToLayer: function(feature, latlng) {\r\n        return L.circleMarker(latlng);\r\n      },\r\n      onEachFeature: function(feature, layer: any) {\r\n        const result = {} as GeocodingResult;\r\n        let bbox;\r\n        let center;\r\n\r\n        if (layer.getBounds) {\r\n          bbox = layer.getBounds();\r\n          center = bbox.getCenter();\r\n        } else if (layer.feature.bbox) {\r\n          center = layer.getLatLng();\r\n          bbox = L.latLngBounds(\r\n            L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(0, 2)),\r\n            L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(2, 4))\r\n          );\r\n        } else {\r\n          center = layer.getLatLng();\r\n          bbox = L.latLngBounds(center, center);\r\n        }\r\n\r\n        result.name = layer.feature.properties.label;\r\n        result.center = center;\r\n        result[bboxname] = bbox;\r\n        result.properties = layer.feature.properties;\r\n        results.push(result);\r\n      }\r\n    });\r\n    return results;\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Pelias}\r\n * @param options the options\r\n */\r\nexport function pelias(options?: Partial<PeliasOptions>) {\r\n  return new Pelias(options);\r\n}\r\n\r\nexport const GeocodeEarth = Pelias;\r\nexport const geocodeEarth = pelias;\r\n\r\n/**\r\n * r.i.p.\r\n * @deprecated\r\n */\r\nexport const Mapzen = Pelias;\r\n/**\r\n * r.i.p.\r\n * @deprecated\r\n */\r\nexport const mapzen = pelias;\r\n\r\n/**\r\n * Implementation of the [Openrouteservice](https://openrouteservice.org/dev/#/api-docs/geocode) geocoder\r\n */\r\nexport class Openrouteservice extends Pelias {\r\n  constructor(options?: Partial<PeliasOptions>) {\r\n    super(\r\n      L.Util.extend(\r\n        {\r\n          serviceUrl: 'https://api.openrouteservice.org/geocode'\r\n        },\r\n        options\r\n      )\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Openrouteservice}\r\n * @param options the options\r\n */\r\nexport function openrouteservice(options?: Partial<PeliasOptions>) {\r\n  return new Openrouteservice(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface PhotonOptions extends GeocoderOptions {\r\n  reverseUrl: string;\r\n  nameProperties: string[];\r\n  htmlTemplate?: (r: any) => string;\r\n}\r\n\r\n/**\r\n * Implementation of the [Photon](http://photon.komoot.de/) geocoder\r\n */\r\nexport class Photon implements IGeocoder {\r\n  options: PhotonOptions = {\r\n    serviceUrl: 'https://photon.komoot.io/api/',\r\n    reverseUrl: 'https://photon.komoot.io/reverse/',\r\n    nameProperties: ['name', 'street', 'suburb', 'hamlet', 'town', 'city', 'state', 'country']\r\n  };\r\n\r\n  constructor(options?: Partial<PhotonOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, { q: query });\r\n    getJSON(\r\n      this.options.serviceUrl,\r\n      params,\r\n      L.Util.bind(function(data) {\r\n        cb.call(context, this._decodeFeatures(data));\r\n      }, this)\r\n    );\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(latLng: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      lat: latLng.lat,\r\n      lon: latLng.lng\r\n    });\r\n    getJSON(\r\n      this.options.reverseUrl,\r\n      params,\r\n      L.Util.bind(function(data) {\r\n        cb.call(context, this._decodeFeatures(data));\r\n      }, this)\r\n    );\r\n  }\r\n\r\n  _decodeFeatures(data: GeoJSON.FeatureCollection<GeoJSON.Point>) {\r\n    const results: GeocodingResult[] = [];\r\n\r\n    if (data && data.features) {\r\n      for (let i = 0; i < data.features.length; i++) {\r\n        const f = data.features[i];\r\n        const c = f.geometry.coordinates;\r\n        const center = L.latLng(c[1], c[0]);\r\n        const extent = f.properties.extent;\r\n\r\n        const bbox = extent\r\n          ? L.latLngBounds([extent[1], extent[0]], [extent[3], extent[2]])\r\n          : L.latLngBounds(center, center);\r\n\r\n        results.push({\r\n          name: this._decodeFeatureName(f),\r\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(f) : undefined,\r\n          center: center,\r\n          bbox: bbox,\r\n          properties: f.properties\r\n        });\r\n      }\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  _decodeFeatureName(f: GeoJSON.Feature) {\r\n    return (this.options.nameProperties || [])\r\n      .map(p => {\r\n        return f.properties[p];\r\n      })\r\n      .filter(v => {\r\n        return !!v;\r\n      })\r\n      .join(', ');\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Photon}\r\n * @param options the options\r\n */\r\nexport function photon(options?: Partial<PhotonOptions>) {\r\n  return new Photon(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface What3WordsOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the What3Words service\r\n */\r\nexport class What3Words implements IGeocoder {\r\n  options: What3WordsOptions = {\r\n    serviceUrl: 'https://api.what3words.com/v2/'\r\n  };\r\n\r\n  constructor(options: Partial<What3WordsOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    //get three words and make a dot based string\r\n    getJSON(\r\n      this.options.serviceUrl + 'forward',\r\n      geocodingParams(this.options, {\r\n        key: this.options.apiKey,\r\n        addr: query.split(/\\s+/).join('.')\r\n      }),\r\n      data => {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.geometry) {\r\n          const latLng = L.latLng(data.geometry['lat'], data.geometry['lng']);\r\n          const latLngBounds = L.latLngBounds(latLng, latLng);\r\n          results[0] = {\r\n            name: data.words,\r\n            bbox: latLngBounds,\r\n            center: latLng\r\n          };\r\n        }\r\n\r\n        cb.call(context, results);\r\n      }\r\n    );\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    getJSON(\r\n      this.options.serviceUrl + 'reverse',\r\n      reverseParams(this.options, {\r\n        key: this.options.apiKey,\r\n        coords: [location.lat, location.lng].join(',')\r\n      }),\r\n      data => {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.status.status == 200) {\r\n          const center = L.latLng(data.geometry['lat'], data.geometry['lng']);\r\n          const bbox = L.latLngBounds(center, center);\r\n          results[0] = {\r\n            name: data.words,\r\n            bbox: bbox,\r\n            center: center\r\n          };\r\n        }\r\n        cb.call(context, results);\r\n      }\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link What3Words}\r\n * @param options the options\r\n */\r\nexport function what3words(options: Partial<What3WordsOptions>) {\r\n  return new What3Words(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { Nominatim } from './geocoders/index';\r\nimport { IGeocoder, GeocodingResult } from './geocoders/api';\r\n\r\nexport interface GeocoderControlOptions extends L.ControlOptions {\r\n  /**\r\n   * Collapse control unless hovered/clicked\r\n   */\r\n  collapsed: boolean;\r\n  /**\r\n   * How to expand a collapsed control: `touch` or `click` or `hover`\r\n   */\r\n  expand: 'touch' | 'click' | 'hover';\r\n  /**\r\n   * Placeholder text for text input\r\n   */\r\n  placeholder: string;\r\n  /**\r\n   * Message when no result found / geocoding error occurs\r\n   */\r\n  errorMessage: string;\r\n  /**\r\n   * Accessibility label for the search icon used by screen readers\r\n   */\r\n  iconLabel: string;\r\n  /**\r\n   * Object to perform the actual geocoding queries\r\n   */\r\n  geocoder?: IGeocoder;\r\n  /**\r\n   * Immediately show the unique result without prompting for alternatives\r\n   */\r\n  showUniqueResult: boolean;\r\n  /**\r\n   * Show icons for geocoding results (if available); supported by Nominatim\r\n   */\r\n  showResultIcons: boolean;\r\n  /**\r\n   * Minimum number characters before suggest functionality is used (if available from geocoder)\r\n   */\r\n  suggestMinLength: number;\r\n  /**\r\n   * Number of milliseconds after typing stopped before suggest functionality is used (if available from geocoder)\r\n   */\r\n  suggestTimeout: number;\r\n  /**\r\n   * Initial query string for text input\r\n   */\r\n  query: string;\r\n  /**\r\n   * Minimum number of characters in search text before performing a query\r\n   */\r\n  queryMinLength: number;\r\n  /**\r\n   * Whether to mark a geocoding result on the map by default\r\n   */\r\n  defaultMarkGeocode: boolean;\r\n}\r\n\r\n\r\n/**\r\n * Leaflet mixins https://leafletjs.com/reference-1.7.1.html#class-includes\r\n * for TypeScript https://www.typescriptlang.org/docs/handbook/mixins.html\r\n * @internal\r\n */\r\nclass EventedControl {\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  constructor(...args: any[]) {\r\n    // empty\r\n  }\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\ninterface EventedControl extends L.Control, L.Evented {}\r\nL.Util.extend(EventedControl.prototype, L.Control.prototype);\r\nL.Util.extend(EventedControl.prototype, L.Evented.prototype);\r\n\r\n/**\r\n * This is the geocoder control. It works like any other [Leaflet control](https://leafletjs.com/reference.html#control), and is added to the map.\r\n */\r\nexport class GeocoderControl extends EventedControl {\r\n  options: GeocoderControlOptions = {\r\n    showUniqueResult: true,\r\n    showResultIcons: false,\r\n    collapsed: true,\r\n    expand: 'touch',\r\n    position: 'topright',\r\n    placeholder: 'Search...',\r\n    errorMessage: 'Nothing found.',\r\n    iconLabel: 'Initiate a new search',\r\n    query: '',\r\n    queryMinLength: 1,\r\n    suggestMinLength: 3,\r\n    suggestTimeout: 250,\r\n    defaultMarkGeocode: true\r\n  };\r\n\r\n  private _alts: HTMLUListElement;\r\n  private _container: HTMLDivElement;\r\n  private _errorElement: HTMLDivElement;\r\n  private _form: HTMLDivElement;\r\n  private _geocodeMarker: L.Marker;\r\n  private _input: HTMLInputElement;\r\n  private _lastGeocode: string;\r\n  private _map: L.Map;\r\n  private _preventBlurCollapse: boolean;\r\n  private _requestCount = 0;\r\n  private _results: any;\r\n  private _selection: any;\r\n  private _suggestTimeout: any;\r\n\r\n  /**\r\n   * Instantiates a geocoder control (to be invoked using `new`)\r\n   * @param options the options\r\n   */\r\n  constructor(options?: Partial<GeocoderControlOptions>) {\r\n    super(options);\r\n    L.Util.setOptions(this, options);\r\n    if (!this.options.geocoder) {\r\n      this.options.geocoder = new Nominatim();\r\n    }\r\n  }\r\n\r\n  addThrobberClass() {\r\n    L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-throbber');\r\n  }\r\n\r\n  removeThrobberClass() {\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-throbber');\r\n  }\r\n\r\n  /**\r\n   * Returns the container DOM element for the control and add listeners on relevant map events.\r\n   * @param map the map instance\r\n   * @see https://leafletjs.com/reference.html#control-onadd\r\n   */\r\n  onAdd(map: L.Map) {\r\n    const className = 'leaflet-control-geocoder';\r\n    const container = L.DomUtil.create('div', className + ' leaflet-bar') as HTMLDivElement;\r\n    const icon = L.DomUtil.create('button', className + '-icon', container) as HTMLButtonElement;\r\n    const form = (this._form = L.DomUtil.create(\r\n      'div',\r\n      className + '-form',\r\n      container\r\n    ) as HTMLDivElement);\r\n\r\n    this._map = map;\r\n    this._container = container;\r\n\r\n    icon.innerHTML = '&nbsp;';\r\n    icon.type = 'button';\r\n    icon.setAttribute('aria-label', this.options.iconLabel);\r\n\r\n    const input = (this._input = L.DomUtil.create('input', '', form) as HTMLInputElement);\r\n    input.type = 'text';\r\n    input.value = this.options.query;\r\n    input.placeholder = this.options.placeholder;\r\n    L.DomEvent.disableClickPropagation(input);\r\n\r\n    this._errorElement = L.DomUtil.create(\r\n      'div',\r\n      className + '-form-no-error',\r\n      container\r\n    ) as HTMLDivElement;\r\n    this._errorElement.innerHTML = this.options.errorMessage;\r\n\r\n    this._alts = L.DomUtil.create(\r\n      'ul',\r\n      className + '-alternatives leaflet-control-geocoder-alternatives-minimized',\r\n      container\r\n    ) as HTMLUListElement;\r\n    L.DomEvent.disableClickPropagation(this._alts);\r\n\r\n    L.DomEvent.addListener(input, 'keydown', this._keydown, this);\r\n    if (this.options.geocoder.suggest) {\r\n      L.DomEvent.addListener(input, 'input', this._change, this);\r\n    }\r\n    L.DomEvent.addListener(input, 'blur', () => {\r\n      if (this.options.collapsed && !this._preventBlurCollapse) {\r\n        this._collapse();\r\n      }\r\n      this._preventBlurCollapse = false;\r\n    });\r\n\r\n    if (this.options.collapsed) {\r\n      if (this.options.expand === 'click') {\r\n        L.DomEvent.addListener(container, 'click', (e: Event) => {\r\n          if ((e as MouseEvent).button === 0 && (e as MouseEvent).detail !== 2) {\r\n            this._toggle();\r\n          }\r\n        });\r\n      } else if (this.options.expand === 'touch') {\r\n        L.DomEvent.addListener(\r\n          container,\r\n          L.Browser.touch ? 'touchstart mousedown' : 'mousedown',\r\n          (e: Event) => {\r\n            this._toggle();\r\n            e.preventDefault(); // mobile: clicking focuses the icon, so UI expands and immediately collapses\r\n            e.stopPropagation();\r\n          },\r\n          this\r\n        );\r\n      } else {\r\n        L.DomEvent.addListener(container, 'mouseover', this._expand, this);\r\n        L.DomEvent.addListener(container, 'mouseout', this._collapse, this);\r\n        this._map.on('movestart', this._collapse, this);\r\n      }\r\n    } else {\r\n      this._expand();\r\n      if (L.Browser.touch) {\r\n        L.DomEvent.addListener(container, 'touchstart', () => this._geocode());\r\n      } else {\r\n        L.DomEvent.addListener(container, 'click', () => this._geocode());\r\n      }\r\n    }\r\n\r\n    if (this.options.defaultMarkGeocode) {\r\n      this.on('markgeocode', this.markGeocode as any, this);\r\n    }\r\n\r\n    this.on('startgeocode', this.addThrobberClass, this);\r\n    this.on('finishgeocode', this.removeThrobberClass, this);\r\n    this.on('startsuggest', this.addThrobberClass, this);\r\n    this.on('finishsuggest', this.removeThrobberClass, this);\r\n\r\n    L.DomEvent.disableClickPropagation(container);\r\n\r\n    return container;\r\n  }\r\n\r\n  /**\r\n   * Sets the query string on the text input\r\n   * @param string the query string\r\n   */\r\n  setQuery(string: string): this {\r\n    this._input.value = string;\r\n    return this;\r\n  }\r\n\r\n  private _geocodeResult(results: GeocodingResult[], suggest: boolean) {\r\n    if (!suggest && this.options.showUniqueResult && results.length === 1) {\r\n      this._geocodeResultSelected(results[0]);\r\n    } else if (results.length > 0) {\r\n      this._alts.innerHTML = '';\r\n      this._results = results;\r\n      L.DomUtil.removeClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\r\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-open');\r\n      for (let i = 0; i < results.length; i++) {\r\n        this._alts.appendChild(this._createAlt(results[i], i));\r\n      }\r\n    } else {\r\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-error');\r\n      L.DomUtil.addClass(this._errorElement, 'leaflet-control-geocoder-error');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Marks a geocoding result on the map\r\n   * @param result the geocoding result\r\n   */\r\n  markGeocode(result: GeocodingResult) {\r\n    result = (result as any).geocode || result;\r\n\r\n    this._map.fitBounds(result.bbox);\r\n\r\n    if (this._geocodeMarker) {\r\n      this._map.removeLayer(this._geocodeMarker);\r\n    }\r\n\r\n    this._geocodeMarker = new L.Marker(result.center)\r\n      .bindPopup(result.html || result.name)\r\n      .addTo(this._map)\r\n      .openPopup();\r\n\r\n    return this;\r\n  }\r\n\r\n  private _geocode(suggest?: boolean) {\r\n    const value = this._input.value;\r\n    if (!suggest && value.length < this.options.queryMinLength) {\r\n      return;\r\n    }\r\n\r\n    const requestCount = ++this._requestCount;\r\n    const cb = (results: GeocodingResult[]) => {\r\n      if (requestCount === this._requestCount) {\r\n        this.fire(suggest ? 'finishsuggest' : 'finishgeocode', { input: value, results });\r\n        this._geocodeResult(results, suggest);\r\n      }\r\n    };\r\n\r\n    this._lastGeocode = value;\r\n    if (!suggest) {\r\n      this._clearResults();\r\n    }\r\n\r\n    this.fire(suggest ? 'startsuggest' : 'startgeocode', { input: value });\r\n    if (suggest) {\r\n      this.options.geocoder.suggest(value, cb);\r\n    } else {\r\n      this.options.geocoder.geocode(value, cb);\r\n    }\r\n  }\r\n\r\n  private _geocodeResultSelected(result: GeocodingResult) {\r\n    this.fire('markgeocode', { geocode: result });\r\n  }\r\n\r\n  private _toggle() {\r\n    if (L.DomUtil.hasClass(this._container, 'leaflet-control-geocoder-expanded')) {\r\n      this._collapse();\r\n    } else {\r\n      this._expand();\r\n    }\r\n  }\r\n\r\n  private _expand() {\r\n    L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-expanded');\r\n    this._input.select();\r\n    this.fire('expand');\r\n  }\r\n\r\n  private _collapse() {\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-expanded');\r\n    L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\r\n    L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\r\n    this._input.blur(); // mobile: keyboard shouldn't stay expanded\r\n    this.fire('collapse');\r\n  }\r\n\r\n  private _clearResults() {\r\n    L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\r\n    this._selection = null;\r\n    L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\r\n  }\r\n\r\n  private _createAlt(result: GeocodingResult, index: number) {\r\n    const li = L.DomUtil.create('li', ''),\r\n      a = L.DomUtil.create('a', '', li),\r\n      icon =\r\n        this.options.showResultIcons && result.icon\r\n          ? (L.DomUtil.create('img', '', a) as HTMLImageElement)\r\n          : null,\r\n      text = result.html ? undefined : document.createTextNode(result.name),\r\n      mouseDownHandler = (e: Event) => {\r\n        // In some browsers, a click will fire on the map if the control is\r\n        // collapsed directly after mousedown. To work around this, we\r\n        // wait until the click is completed, and _then_ collapse the\r\n        // control. Messy, but this is the workaround I could come up with\r\n        // for #142.\r\n        this._preventBlurCollapse = true;\r\n        L.DomEvent.stop(e);\r\n        this._geocodeResultSelected(result);\r\n        L.DomEvent.on(li, 'click touchend', () => {\r\n          if (this.options.collapsed) {\r\n            this._collapse();\r\n          } else {\r\n            this._clearResults();\r\n          }\r\n        });\r\n      };\r\n\r\n    if (icon) {\r\n      icon.src = result.icon;\r\n    }\r\n\r\n    li.setAttribute('data-result-index', String(index));\r\n\r\n    if (result.html) {\r\n      a.innerHTML = a.innerHTML + result.html;\r\n    } else if (text) {\r\n      a.appendChild(text);\r\n    }\r\n\r\n    // Use mousedown and not click, since click will fire _after_ blur,\r\n    // causing the control to have collapsed and removed the items\r\n    // before the click can fire.\r\n    L.DomEvent.addListener(li, 'mousedown touchstart', mouseDownHandler, this);\r\n\r\n    return li;\r\n  }\r\n\r\n  private _keydown(e: KeyboardEvent) {\r\n    const select = (dir: number) => {\r\n      if (this._selection) {\r\n        L.DomUtil.removeClass(this._selection, 'leaflet-control-geocoder-selected');\r\n        this._selection = this._selection[dir > 0 ? 'nextSibling' : 'previousSibling'];\r\n      }\r\n      if (!this._selection) {\r\n        this._selection = this._alts[dir > 0 ? 'firstChild' : 'lastChild'];\r\n      }\r\n\r\n      if (this._selection) {\r\n        L.DomUtil.addClass(this._selection, 'leaflet-control-geocoder-selected');\r\n      }\r\n    };\r\n\r\n    switch (e.keyCode) {\r\n      // Escape\r\n      case 27:\r\n        if (this.options.collapsed) {\r\n          this._collapse();\r\n        } else {\r\n          this._clearResults();\r\n        }\r\n        break;\r\n      // Up\r\n      case 38:\r\n        select(-1);\r\n        break;\r\n      // Up\r\n      case 40:\r\n        select(1);\r\n        break;\r\n      // Enter\r\n      case 13:\r\n        if (this._selection) {\r\n          const index = parseInt(this._selection.getAttribute('data-result-index'), 10);\r\n          this._geocodeResultSelected(this._results[index]);\r\n          this._clearResults();\r\n        } else {\r\n          this._geocode();\r\n        }\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n\r\n    L.DomEvent.preventDefault(e);\r\n  }\r\n\r\n  private _change() {\r\n    const v = this._input.value;\r\n    if (v !== this._lastGeocode) {\r\n      clearTimeout(this._suggestTimeout);\r\n      if (v.length >= this.options.suggestMinLength) {\r\n        this._suggestTimeout = setTimeout(() => this._geocode(true), this.options.suggestTimeout);\r\n      } else {\r\n        this._clearResults();\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link GeocoderControl}\r\n * @param options the options\r\n */\r\nexport function geocoder(options?: Partial<GeocoderControlOptions>) {\r\n  return new GeocoderControl(options);\r\n}\r\n","/* @preserve\r\n * Leaflet Control Geocoder\r\n * https://github.com/perliedman/leaflet-control-geocoder\r\n *\r\n * Copyright (c) 2012 sa3m (https://github.com/sa3m)\r\n * Copyright (c) 2018 Per Liedman\r\n * All rights reserved.\r\n */\r\nimport * as L from 'leaflet';\r\nimport { GeocoderControl as Geocoder, geocoder } from './control';\r\nimport * as geocoders from './geocoders/index';\r\n\r\nL.Util.extend(Geocoder, geocoders);\r\nexport default Geocoder;\r\n\r\nL.Util.extend(L.Control, {\r\n  Geocoder: Geocoder,\r\n  geocoder: geocoder\r\n});\r\n"],"names":["geocodingParams","options","params","L","extend","geocodingQueryParams","reverseParams","reverseQueryParams","lastCallbackId","badChars","possible","escape","escapeChar","chr","htmlEscape","string","test","replace","jsonp","url","callback","context","jsonpParam","callbackId","window","bind","script","document","createElement","type","src","getParamString","id","getElementsByTagName","appendChild","getJSON","xmlHttp","XMLHttpRequest","onreadystatechange","readyState","message","status","response","JSON","parse","e","open","responseType","setRequestHeader","send","template","str","data","key","value","undefined","obj","existingUrl","uppercase","i","encodeURIComponent","toUpperCase","Array","isArray","push","String","j","length","indexOf","join","ArcGis","constructor","serviceUrl","apiKey","setOptions","geocode","query","cb","token","SingleLine","outFields","forStorage","maxLocations","f","results","candidates","loc","latLng","location","y","x","latLngBounds","extent","ymax","xmax","ymin","xmin","name","address","bbox","center","call","suggest","reverse","scale","lng","lat","distance","result","error","Match_addr","arcgis","Bing","resourceSets","resources","resource","point","coordinates","bing","Google","geometry","viewport","northeast","southwest","formatted_address","properties","address_components","latlng","google","HERE","app_id","app_code","Error","searchtext","gen","jsonattributes","prox","reverseGeocodeProxRadius","mode","view","displayPosition","latitude","longitude","mapView","topLeft","bottomRight","label","HEREv2","q","at","in","limit","items","item","position","south","west","north","east","here","parseLatLng","match","LatLng","next","sizeInMeters","toBounds","Mapbox","_getProperties","text","split","short_code","access_token","proximity","features","slice","place_name","param","mapbox","MapQuest","decodeURIComponent","_formatName","parts","filter","s","outFormat","locations","street","adminArea4","adminArea3","adminArea1","outputFormat","mapQuest","Neutrino","userId","found","neutrino","Nominatim","htmlTemplate","r","className","road","building","city","town","village","hamlet","state","country","format","addressdetails","boundingbox","icon","display_name","html","lon","zoom","Math","round","log","nominatim","OpenLocationCode","decoded","decode","latitudeCenter","longitudeCenter","latitudeLo","longitudeLo","latitudeHi","longitudeHi","console","warn","code","encode","codeLength","openLocationCode","OpenCage","annotations","bounds","formatted","opencage","Pelias","api_key","_parseResults","geocoding","timestamp","_lastSuggest","bboxname","pointToLayer","feature","onEachFeature","layer","getBounds","getCenter","getLatLng","coordsToLatLng","pelias","GeocodeEarth","geocodeEarth","Mapzen","mapzen","Openrouteservice","openrouteservice","Photon","reverseUrl","nameProperties","_decodeFeatures","c","_decodeFeatureName","map","p","v","photon","What3Words","addr","words","coords","what3words","EventedControl","args","prototype","GeocoderControl","showUniqueResult","showResultIcons","collapsed","expand","placeholder","errorMessage","iconLabel","queryMinLength","suggestMinLength","suggestTimeout","defaultMarkGeocode","geocoder","addThrobberClass","addClass","_container","removeThrobberClass","removeClass","onAdd","container","create","form","_form","_map","innerHTML","setAttribute","input","_input","disableClickPropagation","_errorElement","_alts","addListener","_keydown","_change","_preventBlurCollapse","_collapse","button","detail","_toggle","touch","preventDefault","stopPropagation","_expand","on","_geocode","markGeocode","setQuery","_geocodeResult","_geocodeResultSelected","_results","_createAlt","fitBounds","_geocodeMarker","removeLayer","bindPopup","addTo","openPopup","requestCount","_requestCount","fire","_lastGeocode","_clearResults","hasClass","select","blur","_selection","index","li","a","createTextNode","mouseDownHandler","stop","dir","keyCode","parseInt","getAttribute","clearTimeout","_suggestTimeout","setTimeout","Geocoder","geocoders"],"mappings":"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"}