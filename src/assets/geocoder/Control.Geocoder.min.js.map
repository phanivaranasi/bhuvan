{"version":3,"file":"Control.Geocoder.min.js","sources":["../src/geocoders/api.ts","../src/util.ts","../src/geocoders/arcgis.ts","../src/geocoders/bing.ts","../src/geocoders/google.ts","../src/geocoders/here.ts","../src/geocoders/latlng.ts","../src/geocoders/mapbox.ts","../src/geocoders/mapquest.ts","../src/geocoders/neutrino.ts","../src/geocoders/nominatim.ts","../src/geocoders/open-location-code.ts","../src/geocoders/opencage.ts","../src/geocoders/pelias.ts","../src/geocoders/photon.ts","../src/geocoders/what3words.ts","../src/control.ts","../src/index.ts"],"sourcesContent":["import * as L from 'leaflet';\r\n\r\n/**\r\n * An object that represents a result from a geocoding query\r\n */\r\nexport interface GeocodingResult {\r\n  /**\r\n   * Name of found location\r\n   */\r\n  name: string;\r\n  /**\r\n   * The bounds of the location\r\n   */\r\n  bbox: L.LatLngBounds;\r\n  /**\r\n   * The center coordinate of the location\r\n   */\r\n  center: L.LatLng;\r\n  /**\r\n   * URL for icon representing result; optional\r\n   */\r\n  icon?: string;\r\n  /**\r\n   * HTML formatted representation of the name\r\n   */\r\n  html?: string;\r\n  /**\r\n   * Additional properties returned by the geocoder\r\n   */\r\n  properties?: any;\r\n}\r\n\r\n/**\r\n * A callback function used in {@link IGeocoder.geocode} and {@link IGeocoder.suggest} and {@link IGeocoder.reverse}\r\n */\r\nexport type GeocodingCallback = (result: GeocodingResult[]) => void;\r\n\r\n/**\r\n * An interface implemented to respond to geocoding queries\r\n */\r\nexport interface IGeocoder {\r\n  /**\r\n   * Performs a geocoding query and returns the results to the callback in the provided context\r\n   * @param query the query\r\n   * @param cb the callback function\r\n   * @param context the `this` context in the callback\r\n   */\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void;\r\n  /**\r\n   * Performs a geocoding query suggestion (this happens while typing) and returns the results to the callback in the provided context\r\n   * @param query the query\r\n   * @param cb the callback function\r\n   * @param context the `this` context in the callback\r\n   */\r\n  suggest?(query: string, cb: GeocodingCallback, context?: any): void;\r\n  /**\r\n   * Performs a reverse geocoding query and returns the results to the callback in the provided context\r\n   * @param location the coordinate to reverse geocode\r\n   * @param scale the map scale possibly used for reverse geocoding\r\n   * @param cb the callback function\r\n   * @param context the `this` context in the callback\r\n   */\r\n  reverse?(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void;\r\n}\r\n\r\nexport interface GeocoderOptions {\r\n  /**\r\n   * URL of the service\r\n   */\r\n  serviceUrl: string;\r\n  /**\r\n   * Additional URL parameters (strings) that will be added to geocoding requests\r\n   */\r\n  geocodingQueryParams?: Record<string, unknown>;\r\n  /**\r\n   * Additional URL parameters (strings) that will be added to reverse geocoding requests\r\n   */\r\n  reverseQueryParams?: Record<string, unknown>;\r\n  /**\r\n   * API key to use this service\r\n   */\r\n  apiKey?: string;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function geocodingParams(\r\n  options: GeocoderOptions,\r\n  params: Record<string, unknown>\r\n): Record<string, unknown> {\r\n  return L.Util.extend(params, options.geocodingQueryParams);\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function reverseParams(\r\n  options: GeocoderOptions,\r\n  params: Record<string, unknown>\r\n): Record<string, unknown> {\r\n  return L.Util.extend(params, options.reverseQueryParams);\r\n}\r\n","import * as L from 'leaflet';\r\n/**\r\n * @internal\r\n */\r\nlet lastCallbackId = 0;\r\n\r\n// Adapted from handlebars.js\r\n// https://github.com/wycats/handlebars.js/\r\n/**\r\n * @internal\r\n */\r\nconst badChars = /[&<>\"'`]/g;\r\n/**\r\n * @internal\r\n */\r\nconst possible = /[&<>\"'`]/;\r\n/**\r\n * @internal\r\n */\r\nconst escape: Record<string, string> = {\r\n  '&': '&amp;',\r\n  '<': '&lt;',\r\n  '>': '&gt;',\r\n  '\"': '&quot;',\r\n  \"'\": '&#x27;',\r\n  '`': '&#x60;'\r\n};\r\n\r\n/**\r\n * @internal\r\n */\r\nfunction escapeChar(chr: string) {\r\n  return escape[chr];\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function htmlEscape(string?: string): string {\r\n  if (string == null) {\r\n    return '';\r\n  } else if (!string) {\r\n    return string + '';\r\n  }\r\n\r\n  // Force a string conversion as this will be done by the append regardless and\r\n  // the regex test will do this transparently behind the scenes, causing issues if\r\n  // an object's to string has escaped characters in it.\r\n  string = '' + string;\r\n\r\n  if (!possible.test(string)) {\r\n    return string;\r\n  }\r\n  return string.replace(badChars, escapeChar);\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function jsonp(\r\n  url: string,\r\n  params: Record<string, any>,\r\n  callback: (message: any) => void,\r\n  context: any,\r\n  jsonpParam?: string\r\n) {\r\n  const callbackId = '_l_geocoder_' + lastCallbackId++;\r\n  params[jsonpParam || 'callback'] = callbackId;\r\n  (window as any)[callbackId] = L.Util.bind(callback, context);\r\n  const script = document.createElement('script');\r\n  script.type = 'text/javascript';\r\n  script.src = url + getParamString(params);\r\n  script.id = callbackId;\r\n  document.getElementsByTagName('head')[0].appendChild(script);\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function getJSON(\r\n  url: string,\r\n  params: Record<string, unknown>,\r\n  callback: (message: any) => void\r\n): void {\r\n  const xmlHttp = new XMLHttpRequest();\r\n  xmlHttp.onreadystatechange = function() {\r\n    if (xmlHttp.readyState !== 4) {\r\n      return;\r\n    }\r\n    let message;\r\n    if (xmlHttp.status !== 200 && xmlHttp.status !== 304) {\r\n      message = '';\r\n    } else if (typeof xmlHttp.response === 'string') {\r\n      // IE doesn't parse JSON responses even with responseType: 'json'.\r\n      try {\r\n        message = JSON.parse(xmlHttp.response);\r\n      } catch (e) {\r\n        // Not a JSON response\r\n        message = xmlHttp.response;\r\n      }\r\n    } else {\r\n      message = xmlHttp.response;\r\n    }\r\n    callback(message);\r\n  };\r\n  xmlHttp.open('GET', url + getParamString(params), true);\r\n  xmlHttp.responseType = 'json';\r\n  xmlHttp.setRequestHeader('Accept', 'application/json');\r\n  xmlHttp.send(null);\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function template(str: string, data: Record<string, any>): string {\r\n  return str.replace(/\\{ *([\\w_]+) *\\}/g, (str, key) => {\r\n    let value = data[key];\r\n    if (value === undefined) {\r\n      value = '';\r\n    } else if (typeof value === 'function') {\r\n      value = value(data);\r\n    }\r\n    return htmlEscape(value);\r\n  });\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function getParamString(\r\n  obj: Record<string, unknown | unknown[]>,\r\n  existingUrl?: string,\r\n  uppercase?: boolean\r\n): string {\r\n  const params = [];\r\n  for (const i in obj) {\r\n    const key = encodeURIComponent(uppercase ? i.toUpperCase() : i);\r\n    const value = obj[i];\r\n    if (!Array.isArray(value)) {\r\n      params.push(key + '=' + encodeURIComponent(String(value)));\r\n    } else {\r\n      for (let j = 0; j < value.length; j++) {\r\n        params.push(key + '=' + encodeURIComponent(value[j]));\r\n      }\r\n    }\r\n  }\r\n  return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface ArcGisOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [ArcGIS geocoder](https://developers.arcgis.com/features/geocoding/)\r\n */\r\nexport class ArcGis implements IGeocoder {\r\n  options: ArcGisOptions = {\r\n    serviceUrl: 'https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer',\r\n    apiKey: ''\r\n  };\r\n\r\n  constructor(options?: Partial<ArcGisOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      token: this.options.apiKey,\r\n      SingleLine: query,\r\n      outFields: 'Addr_Type',\r\n      forStorage: false,\r\n      maxLocations: 10,\r\n      f: 'json'\r\n    });\r\n\r\n    getJSON(this.options.serviceUrl + '/findAddressCandidates', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.candidates && data.candidates.length) {\r\n        for (let i = 0; i <= data.candidates.length - 1; i++) {\r\n          const loc = data.candidates[i];\r\n          const latLng = L.latLng(loc.location.y, loc.location.x);\r\n          const latLngBounds = L.latLngBounds(\r\n            L.latLng(loc.extent.ymax, loc.extent.xmax),\r\n            L.latLng(loc.extent.ymin, loc.extent.xmin)\r\n          );\r\n          results[i] = {\r\n            name: loc.address,\r\n            bbox: latLngBounds,\r\n            center: latLng\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      location: location.lng + ',' + location.lat,\r\n      distance: 100,\r\n      f: 'json'\r\n    });\r\n    getJSON(this.options.serviceUrl + '/reverseGeocode', params, data => {\r\n      const result: GeocodingResult[] = [];\r\n      if (data && !data.error) {\r\n        const center = L.latLng(data.location.y, data.location.x);\r\n        const bbox = L.latLngBounds(center, center);\r\n        result.push({\r\n          name: data.address.Match_addr,\r\n          center: center,\r\n          bbox: bbox\r\n        });\r\n      }\r\n\r\n      cb.call(context, result);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link ArcGis}\r\n * @param options the options\r\n */\r\nexport function arcgis(options?: Partial<ArcGisOptions>) {\r\n  return new ArcGis(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { jsonp } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface BingOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [Bing Locations API](https://docs.microsoft.com/en-us/bingmaps/rest-services/locations/)\r\n */\r\nexport class Bing implements IGeocoder {\r\n  options: BingOptions = {\r\n    serviceUrl: 'https://dev.virtualearth.net/REST/v1/Locations'\r\n  };\r\n\r\n  constructor(options?: Partial<BingOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      query: query,\r\n      key: this.options.apiKey\r\n    });\r\n    jsonp(\r\n      this.options.apiKey,\r\n      params,\r\n      data => {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.resourceSets.length > 0) {\r\n          for (let i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\r\n            const resource = data.resourceSets[0].resources[i],\r\n              bbox = resource.bbox;\r\n            results[i] = {\r\n              name: resource.name,\r\n              bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\r\n              center: L.latLng(resource.point.coordinates)\r\n            };\r\n          }\r\n        }\r\n        cb.call(context, results);\r\n      },\r\n      this,\r\n      'jsonp'\r\n    );\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      key: this.options.apiKey\r\n    });\r\n    jsonp(\r\n      this.options.serviceUrl + location.lat + ',' + location.lng,\r\n      params,\r\n      data => {\r\n        const results: GeocodingResult[] = [];\r\n        for (let i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\r\n          const resource = data.resourceSets[0].resources[i],\r\n            bbox = resource.bbox;\r\n          results[i] = {\r\n            name: resource.name,\r\n            bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\r\n            center: L.latLng(resource.point.coordinates)\r\n          };\r\n        }\r\n        cb.call(context, results);\r\n      },\r\n      this,\r\n      'jsonp'\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Bing}\r\n * @param options the options\r\n */\r\nexport function bing(options?: Partial<BingOptions>) {\r\n  return new Bing(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\n/**\r\n * Implementation of the [Google Geocoding API](https://developers.google.com/maps/documentation/geocoding/)\r\n */\r\nexport interface GoogleOptions extends GeocoderOptions {}\r\n\r\nexport class Google implements IGeocoder {\r\n  options: GoogleOptions = {\r\n    serviceUrl: 'https://maps.googleapis.com/maps/api/geocode/json'\r\n  };\r\n\r\n  constructor(options?: Partial<GoogleOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      key: this.options.apiKey,\r\n      address: query\r\n    });\r\n    getJSON(this.options.serviceUrl, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.results && data.results.length) {\r\n        for (let i = 0; i <= data.results.length - 1; i++) {\r\n          const loc = data.results[i];\r\n          const latLng = L.latLng(loc.geometry.location);\r\n          const latLngBounds = L.latLngBounds(\r\n            L.latLng(loc.geometry.viewport.northeast),\r\n            L.latLng(loc.geometry.viewport.southwest)\r\n          );\r\n          results[i] = {\r\n            name: loc.formatted_address,\r\n            bbox: latLngBounds,\r\n            center: latLng,\r\n            properties: loc.address_components\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      key: this.options.apiKey,\r\n      latlng: location.lat + ',' + location.lng\r\n    });\r\n    getJSON(this.options.serviceUrl, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.results && data.results.length) {\r\n        for (let i = 0; i <= data.results.length - 1; i++) {\r\n          const loc = data.results[i];\r\n          const center = L.latLng(loc.geometry.location);\r\n          const bbox = L.latLngBounds(\r\n            L.latLng(loc.geometry.viewport.northeast),\r\n            L.latLng(loc.geometry.viewport.southwest)\r\n          );\r\n          results[i] = {\r\n            name: loc.formatted_address,\r\n            bbox: bbox,\r\n            center: center,\r\n            properties: loc.address_components\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Google}\r\n * @param options the options\r\n */\r\nexport function google(options?: Partial<GoogleOptions>) {\r\n  return new Google(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface HereOptions extends GeocoderOptions {\r\n  /**\r\n   * Use `apiKey` and the new `HEREv2` geocoder\r\n   * @deprecated\r\n   */\r\n  app_id: string;\r\n  /**\r\n   * Use `apiKey` and the new `HEREv2` geocoder\r\n   * @deprecated\r\n   */\r\n  app_code: string;\r\n  reverseGeocodeProxRadius?: any;\r\n  apiKey: string;\r\n}\r\n\r\n/**\r\n * Implementation of the [HERE Geocoder API](https://developer.here.com/documentation/geocoder/topics/introduction.html)\r\n */\r\nexport class HERE implements IGeocoder {\r\n  options: HereOptions = {\r\n    serviceUrl: 'https://geocoder.api.here.com/6.2/',\r\n    app_id: '',\r\n    app_code: '',\r\n    apiKey: ''\r\n  };\r\n\r\n  constructor(options?: Partial<HereOptions>) {\r\n    L.Util.setOptions(this, options);\r\n    if (options.apiKey) throw Error('apiKey is not supported, use app_id/app_code instead!');\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      searchtext: query,\r\n      gen: 9,\r\n      app_id: this.options.app_id,\r\n      app_code: this.options.app_code,\r\n      jsonattributes: 1\r\n    });\r\n    this.getJSON(this.options.serviceUrl + 'geocode.json', params, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    let prox = location.lat + ',' + location.lng;\r\n    if (this.options.reverseGeocodeProxRadius) {\r\n      prox += ',' + this.options.reverseGeocodeProxRadius;\r\n    }\r\n    const params = reverseParams(this.options, {\r\n      prox,\r\n      mode: 'retrieveAddresses',\r\n      app_id: this.options.app_id,\r\n      app_code: this.options.app_code,\r\n      gen: 9,\r\n      jsonattributes: 1\r\n    });\r\n    this.getJSON(this.options.serviceUrl + 'reversegeocode.json', params, cb, context);\r\n  }\r\n\r\n  getJSON(url: string, params: any, cb: GeocodingCallback, context?: any) {\r\n    getJSON(url, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.response.view && data.response.view.length) {\r\n        for (let i = 0; i <= data.response.view[0].result.length - 1; i++) {\r\n          const loc = data.response.view[0].result[i].location;\r\n          const center = L.latLng(loc.displayPosition.latitude, loc.displayPosition.longitude);\r\n          const bbox = L.latLngBounds(\r\n            L.latLng(loc.mapView.topLeft.latitude, loc.mapView.topLeft.longitude),\r\n            L.latLng(loc.mapView.bottomRight.latitude, loc.mapView.bottomRight.longitude)\r\n          );\r\n          results[i] = {\r\n            name: loc.address.label,\r\n            properties: loc.address,\r\n            bbox: bbox,\r\n            center: center\r\n          };\r\n        }\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Implementation of the new [HERE Geocoder API](https://developer.here.com/documentation/geocoding-search-api/api-reference-swagger.html)\r\n */\r\nexport class HEREv2 implements IGeocoder {\r\n  options: HereOptions = {\r\n    serviceUrl: 'https://geocode.search.hereapi.com/v1',\r\n    apiKey: '',\r\n    app_id: '',\r\n    app_code: ''\r\n  };\r\n\r\n  constructor(options?: Partial<HereOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      q: query,\r\n      apiKey: this.options.apiKey\r\n    });\r\n\r\n    if (!params.at && !params.in) {\r\n      throw Error(\r\n        'at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.'\r\n      );\r\n    }\r\n\r\n    this.getJSON(this.options.serviceUrl + '/discover', params, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      at: location.lat + ',' + location.lng,\r\n      limit: this.options.reverseGeocodeProxRadius,\r\n      apiKey: this.options.apiKey\r\n    });\r\n    this.getJSON(this.options.serviceUrl + '/revgeocode', params, cb, context);\r\n  }\r\n\r\n  getJSON(url: string, params: any, cb: GeocodingCallback, context?: any) {\r\n    getJSON(url, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n\r\n      if (data.items && data.items.length) {\r\n        for (let i = 0; i <= data.items.length - 1; i++) {\r\n          const item = data.items[i];\r\n          const latLng = L.latLng(item.position.lat, item.position.lng);\r\n          let bbox: L.LatLngBounds;\r\n          if (item.mapView) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(item.mapView.south, item.mapView.west),\r\n              L.latLng(item.mapView.north, item.mapView.east)\r\n            );\r\n          } else {\r\n            // Using only position when not provided\r\n            bbox = L.latLngBounds(\r\n              L.latLng(item.position.lat, item.position.lng),\r\n              L.latLng(item.position.lat, item.position.lng)\r\n            );\r\n          }\r\n          results[i] = {\r\n            name: item.address.label,\r\n            properties: item.address,\r\n            bbox: bbox,\r\n            center: latLng\r\n          };\r\n        }\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link HERE}\r\n * @param options the options\r\n */\r\nexport function here(options?: Partial<HereOptions>) {\r\n  if (options.apiKey) {\r\n    return new HEREv2(options);\r\n  } else {\r\n    return new HERE(options);\r\n  }\r\n}\r\n","import * as L from 'leaflet';\r\nimport { IGeocoder, GeocodingCallback, GeocodingResult } from './api';\r\n\r\nexport interface LatLngOptions {\r\n  /**\r\n   * The next geocoder to use for non-supported queries\r\n   */\r\n  next?: IGeocoder;\r\n  /**\r\n   * The size in meters used for passing to `LatLng.toBounds`\r\n   */\r\n  sizeInMeters: number;\r\n}\r\n\r\n/**\r\n * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\r\n * @param query the latitude/longitude string to parse\r\n * @returns the parsed latitude/longitude\r\n */\r\nexport function parseLatLng(query: string): L.LatLng | undefined {\r\n  let match;\r\n  // regex from https://github.com/openstreetmap/openstreetmap-website/blob/master/app/controllers/geocoder_controller.rb\r\n  if ((match = query.match(/^([NS])\\s*(\\d{1,3}(?:\\.\\d*)?)\\W*([EW])\\s*(\\d{1,3}(?:\\.\\d*)?)$/))) {\r\n    // [NSEW] decimal degrees\r\n    return L.latLng(\r\n      (/N/i.test(match[1]) ? 1 : -1) * +match[2],\r\n      (/E/i.test(match[3]) ? 1 : -1) * +match[4]\r\n    );\r\n  } else if (\r\n    (match = query.match(/^(\\d{1,3}(?:\\.\\d*)?)\\s*([NS])\\W*(\\d{1,3}(?:\\.\\d*)?)\\s*([EW])$/))\r\n  ) {\r\n    // decimal degrees [NSEW]\r\n    return L.latLng(\r\n      (/N/i.test(match[2]) ? 1 : -1) * +match[1],\r\n      (/E/i.test(match[4]) ? 1 : -1) * +match[3]\r\n    );\r\n  } else if (\r\n    (match = query.match(\r\n      /^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?$/\r\n    ))\r\n  ) {\r\n    // [NSEW] degrees, decimal minutes\r\n    return L.latLng(\r\n      (/N/i.test(match[1]) ? 1 : -1) * (+match[2] + +match[3] / 60),\r\n      (/E/i.test(match[4]) ? 1 : -1) * (+match[5] + +match[6] / 60)\r\n    );\r\n  } else if (\r\n    (match = query.match(\r\n      /^(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([EW])$/\r\n    ))\r\n  ) {\r\n    // degrees, decimal minutes [NSEW]\r\n    return L.latLng(\r\n      (/N/i.test(match[3]) ? 1 : -1) * (+match[1] + +match[2] / 60),\r\n      (/E/i.test(match[6]) ? 1 : -1) * (+match[4] + +match[5] / 60)\r\n    );\r\n  } else if (\r\n    (match = query.match(\r\n      /^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?$/\r\n    ))\r\n  ) {\r\n    // [NSEW] degrees, minutes, decimal seconds\r\n    return L.latLng(\r\n      (/N/i.test(match[1]) ? 1 : -1) * (+match[2] + +match[3] / 60 + +match[4] / 3600),\r\n      (/E/i.test(match[5]) ? 1 : -1) * (+match[6] + +match[7] / 60 + +match[8] / 3600)\r\n    );\r\n  } else if (\r\n    (match = query.match(\r\n      /^(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\s*([EW])$/\r\n    ))\r\n  ) {\r\n    // degrees, minutes, decimal seconds [NSEW]\r\n    return L.latLng(\r\n      (/N/i.test(match[4]) ? 1 : -1) * (+match[1] + +match[2] / 60 + +match[3] / 3600),\r\n      (/E/i.test(match[8]) ? 1 : -1) * (+match[5] + +match[6] / 60 + +match[7] / 3600)\r\n    );\r\n  } else if ((match = query.match(/^\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*[\\s,]\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*$/))) {\r\n    return L.latLng(+match[1], +match[2]);\r\n  }\r\n}\r\n\r\n/**\r\n * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\r\n */\r\nexport class LatLng implements IGeocoder {\r\n  options: LatLngOptions = {\r\n    next: undefined,\r\n    sizeInMeters: 10000\r\n  };\r\n\r\n  constructor(options?: Partial<LatLngOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\r\n    const center = parseLatLng(query);\r\n    if (center) {\r\n      const results: GeocodingResult[] = [\r\n        {\r\n          name: query,\r\n          center: center,\r\n          bbox: center.toBounds(this.options.sizeInMeters)\r\n        }\r\n      ];\r\n      cb.call(context, results);\r\n    } else if (this.options.next) {\r\n      this.options.next.geocode(query, cb, context);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link LatLng}\r\n * @param options the options\r\n */\r\nexport function latLng(options?: Partial<LatLngOptions>) {\r\n  return new LatLng(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface MapboxOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [Mapbox Geocoding](https://www.mapbox.com/api-documentation/#geocoding)\r\n */\r\nexport class Mapbox implements IGeocoder {\r\n  options: MapboxOptions = {\r\n    serviceUrl: 'https://api.mapbox.com/geocoding/v5/mapbox.places/'\r\n  };\r\n\r\n  constructor(options?: Partial<MapboxOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  _getProperties(loc) {\r\n    const properties = {\r\n      text: loc.text,\r\n      address: loc.address\r\n    };\r\n\r\n    for (let j = 0; j < (loc.context || []).length; j++) {\r\n      const id = loc.context[j].id.split('.')[0];\r\n      properties[id] = loc.context[j].text;\r\n\r\n      // Get country code when available\r\n      if (loc.context[j].short_code) {\r\n        properties['countryShortCode'] = loc.context[j].short_code;\r\n      }\r\n    }\r\n    return properties;\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params: any = geocodingParams(this.options, {\r\n      access_token: this.options.apiKey\r\n    });\r\n    if (\r\n      params.proximity !== undefined &&\r\n      params.proximity.lat !== undefined &&\r\n      params.proximity.lng !== undefined\r\n    ) {\r\n      params.proximity = params.proximity.lng + ',' + params.proximity.lat;\r\n    }\r\n    getJSON(this.options.serviceUrl + encodeURIComponent(query) + '.json', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.features && data.features.length) {\r\n        for (let i = 0; i <= data.features.length - 1; i++) {\r\n          const loc = data.features[i];\r\n          const center = L.latLng(loc.center.reverse());\r\n          let bbox: L.LatLngBounds;\r\n          if (loc.bbox) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(loc.bbox.slice(0, 2).reverse()),\r\n              L.latLng(loc.bbox.slice(2, 4).reverse())\r\n            );\r\n          } else {\r\n            bbox = L.latLngBounds(center, center);\r\n          }\r\n\r\n          results[i] = {\r\n            name: loc.place_name,\r\n            bbox: bbox,\r\n            center: center,\r\n            properties: this._getProperties(loc)\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const url = this.options.serviceUrl + location.lng + ',' + location.lat + '.json';\r\n    const param = reverseParams(this.options, {\r\n      access_token: this.options.apiKey\r\n    });\r\n    getJSON(url, param, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.features && data.features.length) {\r\n        for (let i = 0; i <= data.features.length - 1; i++) {\r\n          const loc = data.features[i];\r\n          const center = L.latLng(loc.center.reverse());\r\n          let bbox: L.LatLngBounds;\r\n          if (loc.bbox) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(loc.bbox.slice(0, 2).reverse()),\r\n              L.latLng(loc.bbox.slice(2, 4).reverse())\r\n            );\r\n          } else {\r\n            bbox = L.latLngBounds(center, center);\r\n          }\r\n          results[i] = {\r\n            name: loc.place_name,\r\n            bbox: bbox,\r\n            center: center,\r\n            properties: this._getProperties(loc)\r\n          };\r\n        }\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Mapbox}\r\n * @param options the options\r\n */\r\nexport function mapbox(options?: Partial<MapboxOptions>) {\r\n  return new Mapbox(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface MapQuestOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [MapQuest Geocoding API](http://developer.mapquest.com/web/products/dev-services/geocoding-ws)\r\n */\r\nexport class MapQuest implements IGeocoder {\r\n  options: MapQuestOptions = {\r\n    serviceUrl: 'https://www.mapquestapi.com/geocoding/v1'\r\n  };\r\n\r\n  constructor(options?: Partial<MapQuestOptions>) {\r\n    L.Util.setOptions(this, options);\r\n    // MapQuest seems to provide URI encoded API keys,\r\n    // so to avoid encoding them twice, we decode them here\r\n    this.options.apiKey = decodeURIComponent(this.options.apiKey);\r\n  }\r\n\r\n  _formatName(...parts: string[]) {\r\n    return parts.filter(s => !!s).join(', ');\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      key: this.options.apiKey,\r\n      location: query,\r\n      limit: 5,\r\n      outFormat: 'json'\r\n    });\r\n    getJSON(\r\n      this.options.serviceUrl + '/address',\r\n      params,\r\n      L.Util.bind(function(data) {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.results && data.results[0].locations) {\r\n          for (let i = data.results[0].locations.length - 1; i >= 0; i--) {\r\n            const loc = data.results[0].locations[i];\r\n            const center = L.latLng(loc.latLng);\r\n            results[i] = {\r\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\r\n              bbox: L.latLngBounds(center, center),\r\n              center: center\r\n            };\r\n          }\r\n        }\r\n\r\n        cb.call(context, results);\r\n      }, this)\r\n    );\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      key: this.options.apiKey,\r\n      location: location.lat + ',' + location.lng,\r\n      outputFormat: 'json'\r\n    });\r\n    getJSON(\r\n      this.options.serviceUrl + '/reverse',\r\n      params,\r\n      L.Util.bind(function(data) {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.results && data.results[0].locations) {\r\n          for (let i = data.results[0].locations.length - 1; i >= 0; i--) {\r\n            const loc = data.results[0].locations[i];\r\n            const center = L.latLng(loc.latLng);\r\n            results[i] = {\r\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\r\n              bbox: L.latLngBounds(center, center),\r\n              center: center\r\n            };\r\n          }\r\n        }\r\n\r\n        cb.call(context, results);\r\n      }, this)\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link MapQuest}\r\n * @param options the options\r\n */\r\nexport function mapQuest(options?: Partial<MapQuestOptions>) {\r\n  return new MapQuest(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface NeutrinoOptions extends GeocoderOptions {\r\n  userId: string;\r\n}\r\n\r\n/**\r\n * Implementation of the [Neutrino API](https://www.neutrinoapi.com/api/geocode-address/)\r\n */\r\nexport class Neutrino implements IGeocoder {\r\n  options: NeutrinoOptions = {\r\n    userId: undefined,\r\n    apiKey: undefined,\r\n    serviceUrl: 'https://neutrinoapi.com/'\r\n  };\r\n\r\n  constructor(options?: Partial<NeutrinoOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  // https://www.neutrinoapi.com/api/geocode-address/\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      apiKey: this.options.apiKey,\r\n      userId: this.options.userId,\r\n      //get three words and make a dot based string\r\n      address: query.split(/\\s+/).join('.')\r\n    });\r\n    getJSON(this.options.serviceUrl + 'geocode-address', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.locations) {\r\n        data.geometry = data.locations[0];\r\n        const center = L.latLng(data.geometry['latitude'], data.geometry['longitude']);\r\n        const bbox = L.latLngBounds(center, center);\r\n        results[0] = {\r\n          name: data.geometry.address,\r\n          bbox: bbox,\r\n          center: center\r\n        };\r\n      }\r\n\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  // https://www.neutrinoapi.com/api/geocode-reverse/\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      apiKey: this.options.apiKey,\r\n      userId: this.options.userId,\r\n      latitude: location.lat,\r\n      longitude: location.lng\r\n    });\r\n    getJSON(this.options.serviceUrl + 'geocode-reverse', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.status.status == 200 && data.found) {\r\n        const center = L.latLng(location.lat, location.lng);\r\n        const bbox = L.latLngBounds(center, center);\r\n        results[0] = {\r\n          name: data.address,\r\n          bbox: bbox,\r\n          center: center\r\n        };\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Neutrino}\r\n * @param options the options\r\n */\r\nexport function neutrino(options?: Partial<NeutrinoOptions>) {\r\n  return new Neutrino(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { template, getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface NominatimResult {\r\n  place_id: number;\r\n  licence: string;\r\n  osm_type: string;\r\n  osm_id: number;\r\n  boundingbox: string[];\r\n  lat: string;\r\n  lon: string;\r\n  display_name: string;\r\n  class: string;\r\n  type: string;\r\n  importance: number;\r\n  icon?: string;\r\n  address: NominatimAddress;\r\n}\r\n\r\nexport interface NominatimAddress {\r\n  building?: string;\r\n  city_district?: string;\r\n  city?: string;\r\n  country_code?: string;\r\n  country?: string;\r\n  county?: string;\r\n  hamlet?: string;\r\n  house_number?: string;\r\n  neighbourhood?: string;\r\n  postcode?: string;\r\n  road?: string;\r\n  state_district?: string;\r\n  state?: string;\r\n  suburb?: string;\r\n  village?: string;\r\n}\r\n\r\nexport interface NominatimOptions extends GeocoderOptions {\r\n  /**\r\n   * Additional URL parameters (strings) that will be added to geocoding requests; can be used to restrict results to a specific country for example, by providing the [`countrycodes`](https://wiki.openstreetmap.org/wiki/Nominatim#Parameters) parameter to Nominatim\r\n   */\r\n  geocodingQueryParams?: Record<string, unknown>;\r\n  /**\r\n   * A function that takes an GeocodingResult as argument and returns an HTML formatted string that represents the result. Default function breaks up address in parts from most to least specific, in attempt to increase readability compared to Nominatim's naming\r\n   */\r\n  htmlTemplate: (r: NominatimResult) => string;\r\n}\r\n\r\n/**\r\n * Implementation of the [Nominatim](https://wiki.openstreetmap.org/wiki/Nominatim) geocoder.\r\n *\r\n * This is the default geocoding service used by the control, unless otherwise specified in the options.\r\n *\r\n * Unless using your own Nominatim installation, please refer to the [Nominatim usage policy](https://operations.osmfoundation.org/policies/nominatim/).\r\n */\r\nexport class Nominatim implements IGeocoder {\r\n  options: NominatimOptions = {\r\n    serviceUrl: 'https://nominatim.openstreetmap.org/',\r\n    htmlTemplate: function(r: NominatimResult) {\r\n      const address = r.address;\r\n      let className: string;\r\n      const parts = [];\r\n      if (address.road || address.building) {\r\n        parts.push('{building} {road} {house_number}');\r\n      }\r\n\r\n      if (address.city || (address as any).town || address.village || address.hamlet) {\r\n        className = parts.length > 0 ? 'leaflet-control-geocoder-address-detail' : '';\r\n        parts.push(\r\n          '<span class=\"' + className + '\">{postcode} {city} {town} {village} {hamlet}</span>'\r\n        );\r\n      }\r\n\r\n      if (address.state || address.country) {\r\n        className = parts.length > 0 ? 'leaflet-control-geocoder-address-context' : '';\r\n        parts.push('<span class=\"' + className + '\">{state} {country}</span>');\r\n      }\r\n\r\n      return template(parts.join('<br/>'), address);\r\n    }\r\n  };\r\n\r\n  constructor(options?: Partial<NominatimOptions>) {\r\n    L.Util.setOptions(this, options || {});\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\r\n    const params = geocodingParams(this.options, {\r\n      q: query,\r\n      limit: 5,\r\n      format: 'json',\r\n      addressdetails: 1\r\n    });\r\n    getJSON(this.options.serviceUrl + 'search', params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      for (let i = data.length - 1; i >= 0; i--) {\r\n        const bbox = data[i].boundingbox;\r\n        for (let j = 0; j < 4; j++) bbox[j] = +bbox[j];\r\n        results[i] = {\r\n          icon: data[i].icon,\r\n          name: data[i].display_name,\r\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(data[i]) : undefined,\r\n          bbox: L.latLngBounds([bbox[0], bbox[2]], [bbox[1], bbox[3]]),\r\n          center: L.latLng(data[i].lat, data[i].lon),\r\n          properties: data[i]\r\n        };\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any) {\r\n    const params = reverseParams(this.options, {\r\n      lat: location.lat,\r\n      lon: location.lng,\r\n      zoom: Math.round(Math.log(scale / 256) / Math.log(2)),\r\n      addressdetails: 1,\r\n      format: 'json'\r\n    });\r\n    getJSON(this.options.serviceUrl + 'reverse', params, data => {\r\n      const result: GeocodingResult[] = [];\r\n      if (data && data.lat && data.lon) {\r\n        const center = L.latLng(data.lat, data.lon);\r\n        const bbox = L.latLngBounds(center, center);\r\n        result.push({\r\n          name: data.display_name,\r\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(data) : undefined,\r\n          center: center,\r\n          bbox: bbox,\r\n          properties: data\r\n        });\r\n      }\r\n      cb.call(context, result);\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Nominatim}\r\n * @param options the options\r\n */\r\nexport function nominatim(options?: Partial<NominatimOptions>) {\r\n  return new Nominatim(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { IGeocoder, GeocodingCallback, GeocodingResult } from './api';\r\n\r\nexport interface OpenLocationCodeOptions {\r\n  OpenLocationCode: OpenLocationCodeApi;\r\n  codeLength?: number;\r\n}\r\n\r\nexport interface OpenLocationCodeApi {\r\n  encode(latitude: number, longitude: number, codeLength?: number): string;\r\n  decode(code: string): CodeArea;\r\n}\r\n\r\nexport interface CodeArea {\r\n  latitudeLo: number;\r\n  longitudeLo: number;\r\n  latitudeHi: number;\r\n  longitudeHi: number;\r\n  latitudeCenter: number;\r\n  longitudeCenter: number;\r\n  codeLength: number;\r\n}\r\n\r\n/**\r\n * Implementation of the [Plus codes](https://plus.codes/) (formerly OpenLocationCode) (requires [open-location-code](https://www.npmjs.com/package/open-location-code))\r\n */\r\nexport class OpenLocationCode implements IGeocoder {\r\n  options: OpenLocationCodeOptions;\r\n  constructor(options?: Partial<OpenLocationCodeOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\r\n    try {\r\n      const decoded = this.options.OpenLocationCode.decode(query);\r\n      const result: GeocodingResult = {\r\n        name: query,\r\n        center: L.latLng(decoded.latitudeCenter, decoded.longitudeCenter),\r\n        bbox: L.latLngBounds(\r\n          L.latLng(decoded.latitudeLo, decoded.longitudeLo),\r\n          L.latLng(decoded.latitudeHi, decoded.longitudeHi)\r\n        )\r\n      };\r\n      cb.call(context, [result]);\r\n    } catch (e) {\r\n      console.warn(e); // eslint-disable-line no-console\r\n      cb.call(context, []);\r\n    }\r\n  }\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any) {\r\n    try {\r\n      const code = this.options.OpenLocationCode.encode(\r\n        location.lat,\r\n        location.lng,\r\n        this.options.codeLength\r\n      );\r\n      const result = {\r\n        name: code,\r\n        center: L.latLng(location.lat, location.lng),\r\n        bbox: L.latLngBounds(\r\n          L.latLng(location.lat, location.lng),\r\n          L.latLng(location.lat, location.lng)\r\n        )\r\n      };\r\n      cb.call(context, [result]);\r\n    } catch (e) {\r\n      console.warn(e); // eslint-disable-line no-console\r\n      cb.call(context, []);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link OpenLocationCode}\r\n * @param options the options\r\n */\r\nexport function openLocationCode(options?: Partial<OpenLocationCodeOptions>) {\r\n  return new OpenLocationCode(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface OpenCageOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [OpenCage Data API](https://opencagedata.com/)\r\n */\r\nexport class OpenCage implements IGeocoder {\r\n  options: OpenCageOptions = {\r\n    serviceUrl: 'https://api.opencagedata.com/geocode/v1/json'\r\n  };\r\n\r\n  constructor(options?: Partial<OpenCageOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      key: this.options.apiKey,\r\n      q: query\r\n    });\r\n    getJSON(this.options.serviceUrl, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.results && data.results.length) {\r\n        for (let i = 0; i < data.results.length; i++) {\r\n          const loc = data.results[i];\r\n          const center = L.latLng(loc.geometry);\r\n          let bbox: L.LatLngBounds;\r\n          if (loc.annotations && loc.annotations.bounds) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(loc.annotations.bounds.northeast),\r\n              L.latLng(loc.annotations.bounds.southwest)\r\n            );\r\n          } else {\r\n            bbox = L.latLngBounds(center, center);\r\n          }\r\n          results.push({\r\n            name: loc.formatted,\r\n            bbox: bbox,\r\n            center: center\r\n          });\r\n        }\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      key: this.options.apiKey,\r\n      q: [location.lat, location.lng].join(',')\r\n    });\r\n    getJSON(this.options.serviceUrl, params, data => {\r\n      const results: GeocodingResult[] = [];\r\n      if (data.results && data.results.length) {\r\n        for (let i = 0; i < data.results.length; i++) {\r\n          const loc = data.results[i];\r\n          const center = L.latLng(loc.geometry);\r\n          let bbox: L.LatLngBounds;\r\n          if (loc.annotations && loc.annotations.bounds) {\r\n            bbox = L.latLngBounds(\r\n              L.latLng(loc.annotations.bounds.northeast),\r\n              L.latLng(loc.annotations.bounds.southwest)\r\n            );\r\n          } else {\r\n            bbox = L.latLngBounds(center, center);\r\n          }\r\n          results.push({\r\n            name: loc.formatted,\r\n            bbox: bbox,\r\n            center: center\r\n          });\r\n        }\r\n      }\r\n      cb.call(context, results);\r\n    });\r\n  }\r\n}\r\n\r\nexport function opencage(options?: Partial<OpenCageOptions>) {\r\n  return new OpenCage(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface PeliasOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the [Pelias](https://pelias.io/), [geocode.earth](https://geocode.earth/) geocoder (formerly Mapzen Search)\r\n */\r\nexport class Pelias implements IGeocoder {\r\n  options: PeliasOptions = {\r\n    serviceUrl: 'https://api.geocode.earth/v1'\r\n  };\r\n\r\n  private _lastSuggest = 0;\r\n\r\n  constructor(options?: Partial<PeliasOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      api_key: this.options.apiKey,\r\n      text: query\r\n    });\r\n    getJSON(this.options.serviceUrl + '/search', params, data => {\r\n      cb.call(context, this._parseResults(data, 'bbox'));\r\n    });\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, {\r\n      api_key: this.options.apiKey,\r\n      text: query\r\n    });\r\n    getJSON(this.options.serviceUrl + '/autocomplete', params, data => {\r\n      if (data.geocoding.timestamp > this._lastSuggest) {\r\n        this._lastSuggest = data.geocoding.timestamp;\r\n        cb.call(context, this._parseResults(data, 'bbox'));\r\n      }\r\n    });\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      api_key: this.options.apiKey,\r\n      'point.lat': location.lat,\r\n      'point.lon': location.lng\r\n    });\r\n    getJSON(this.options.serviceUrl + '/reverse', params, data => {\r\n      cb.call(context, this._parseResults(data, 'bounds'));\r\n    });\r\n  }\r\n\r\n  _parseResults(data, bboxname) {\r\n    const results: GeocodingResult[] = [];\r\n    L.geoJSON(data, {\r\n      pointToLayer: function(feature, latlng) {\r\n        return L.circleMarker(latlng);\r\n      },\r\n      onEachFeature: function(feature, layer: any) {\r\n        const result = {} as GeocodingResult;\r\n        let bbox;\r\n        let center;\r\n\r\n        if (layer.getBounds) {\r\n          bbox = layer.getBounds();\r\n          center = bbox.getCenter();\r\n        } else if (layer.feature.bbox) {\r\n          center = layer.getLatLng();\r\n          bbox = L.latLngBounds(\r\n            L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(0, 2)),\r\n            L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(2, 4))\r\n          );\r\n        } else {\r\n          center = layer.getLatLng();\r\n          bbox = L.latLngBounds(center, center);\r\n        }\r\n\r\n        result.name = layer.feature.properties.label;\r\n        result.center = center;\r\n        result[bboxname] = bbox;\r\n        result.properties = layer.feature.properties;\r\n        results.push(result);\r\n      }\r\n    });\r\n    return results;\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Pelias}\r\n * @param options the options\r\n */\r\nexport function pelias(options?: Partial<PeliasOptions>) {\r\n  return new Pelias(options);\r\n}\r\n\r\nexport const GeocodeEarth = Pelias;\r\nexport const geocodeEarth = pelias;\r\n\r\n/**\r\n * r.i.p.\r\n * @deprecated\r\n */\r\nexport const Mapzen = Pelias;\r\n/**\r\n * r.i.p.\r\n * @deprecated\r\n */\r\nexport const mapzen = pelias;\r\n\r\n/**\r\n * Implementation of the [Openrouteservice](https://openrouteservice.org/dev/#/api-docs/geocode) geocoder\r\n */\r\nexport class Openrouteservice extends Pelias {\r\n  constructor(options?: Partial<PeliasOptions>) {\r\n    super(\r\n      L.Util.extend(\r\n        {\r\n          serviceUrl: 'https://api.openrouteservice.org/geocode'\r\n        },\r\n        options\r\n      )\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Openrouteservice}\r\n * @param options the options\r\n */\r\nexport function openrouteservice(options?: Partial<PeliasOptions>) {\r\n  return new Openrouteservice(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface PhotonOptions extends GeocoderOptions {\r\n  reverseUrl: string;\r\n  nameProperties: string[];\r\n  htmlTemplate?: (r: any) => string;\r\n}\r\n\r\n/**\r\n * Implementation of the [Photon](http://photon.komoot.de/) geocoder\r\n */\r\nexport class Photon implements IGeocoder {\r\n  options: PhotonOptions = {\r\n    serviceUrl: 'https://photon.komoot.io/api/',\r\n    reverseUrl: 'https://photon.komoot.io/reverse/',\r\n    nameProperties: ['name', 'street', 'suburb', 'hamlet', 'town', 'city', 'state', 'country']\r\n  };\r\n\r\n  constructor(options?: Partial<PhotonOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    const params = geocodingParams(this.options, { q: query });\r\n    getJSON(\r\n      this.options.serviceUrl,\r\n      params,\r\n      L.Util.bind(function(data) {\r\n        cb.call(context, this._decodeFeatures(data));\r\n      }, this)\r\n    );\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(latLng: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    const params = reverseParams(this.options, {\r\n      lat: latLng.lat,\r\n      lon: latLng.lng\r\n    });\r\n    getJSON(\r\n      this.options.reverseUrl,\r\n      params,\r\n      L.Util.bind(function(data) {\r\n        cb.call(context, this._decodeFeatures(data));\r\n      }, this)\r\n    );\r\n  }\r\n\r\n  _decodeFeatures(data: GeoJSON.FeatureCollection<GeoJSON.Point>) {\r\n    const results: GeocodingResult[] = [];\r\n\r\n    if (data && data.features) {\r\n      for (let i = 0; i < data.features.length; i++) {\r\n        const f = data.features[i];\r\n        const c = f.geometry.coordinates;\r\n        const center = L.latLng(c[1], c[0]);\r\n        const extent = f.properties.extent;\r\n\r\n        const bbox = extent\r\n          ? L.latLngBounds([extent[1], extent[0]], [extent[3], extent[2]])\r\n          : L.latLngBounds(center, center);\r\n\r\n        results.push({\r\n          name: this._decodeFeatureName(f),\r\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(f) : undefined,\r\n          center: center,\r\n          bbox: bbox,\r\n          properties: f.properties\r\n        });\r\n      }\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  _decodeFeatureName(f: GeoJSON.Feature) {\r\n    return (this.options.nameProperties || [])\r\n      .map(p => {\r\n        return f.properties[p];\r\n      })\r\n      .filter(v => {\r\n        return !!v;\r\n      })\r\n      .join(', ');\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Photon}\r\n * @param options the options\r\n */\r\nexport function photon(options?: Partial<PhotonOptions>) {\r\n  return new Photon(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { getJSON } from '../util';\r\nimport {\r\n  IGeocoder,\r\n  GeocoderOptions,\r\n  GeocodingCallback,\r\n  geocodingParams,\r\n  GeocodingResult,\r\n  reverseParams\r\n} from './api';\r\n\r\nexport interface What3WordsOptions extends GeocoderOptions {}\r\n\r\n/**\r\n * Implementation of the What3Words service\r\n */\r\nexport class What3Words implements IGeocoder {\r\n  options: What3WordsOptions = {\r\n    serviceUrl: 'https://api.what3words.com/v2/'\r\n  };\r\n\r\n  constructor(options: Partial<What3WordsOptions>) {\r\n    L.Util.setOptions(this, options);\r\n  }\r\n\r\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\r\n    //get three words and make a dot based string\r\n    getJSON(\r\n      this.options.serviceUrl + 'forward',\r\n      geocodingParams(this.options, {\r\n        key: this.options.apiKey,\r\n        addr: query.split(/\\s+/).join('.')\r\n      }),\r\n      data => {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.geometry) {\r\n          const latLng = L.latLng(data.geometry['lat'], data.geometry['lng']);\r\n          const latLngBounds = L.latLngBounds(latLng, latLng);\r\n          results[0] = {\r\n            name: data.words,\r\n            bbox: latLngBounds,\r\n            center: latLng\r\n          };\r\n        }\r\n\r\n        cb.call(context, results);\r\n      }\r\n    );\r\n  }\r\n\r\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\r\n    return this.geocode(query, cb, context);\r\n  }\r\n\r\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\r\n    getJSON(\r\n      this.options.serviceUrl + 'reverse',\r\n      reverseParams(this.options, {\r\n        key: this.options.apiKey,\r\n        coords: [location.lat, location.lng].join(',')\r\n      }),\r\n      data => {\r\n        const results: GeocodingResult[] = [];\r\n        if (data.status.status == 200) {\r\n          const center = L.latLng(data.geometry['lat'], data.geometry['lng']);\r\n          const bbox = L.latLngBounds(center, center);\r\n          results[0] = {\r\n            name: data.words,\r\n            bbox: bbox,\r\n            center: center\r\n          };\r\n        }\r\n        cb.call(context, results);\r\n      }\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link What3Words}\r\n * @param options the options\r\n */\r\nexport function what3words(options: Partial<What3WordsOptions>) {\r\n  return new What3Words(options);\r\n}\r\n","import * as L from 'leaflet';\r\nimport { Nominatim } from './geocoders/index';\r\nimport { IGeocoder, GeocodingResult } from './geocoders/api';\r\n\r\nexport interface GeocoderControlOptions extends L.ControlOptions {\r\n  /**\r\n   * Collapse control unless hovered/clicked\r\n   */\r\n  collapsed: boolean;\r\n  /**\r\n   * How to expand a collapsed control: `touch` or `click` or `hover`\r\n   */\r\n  expand: 'touch' | 'click' | 'hover';\r\n  /**\r\n   * Placeholder text for text input\r\n   */\r\n  placeholder: string;\r\n  /**\r\n   * Message when no result found / geocoding error occurs\r\n   */\r\n  errorMessage: string;\r\n  /**\r\n   * Accessibility label for the search icon used by screen readers\r\n   */\r\n  iconLabel: string;\r\n  /**\r\n   * Object to perform the actual geocoding queries\r\n   */\r\n  geocoder?: IGeocoder;\r\n  /**\r\n   * Immediately show the unique result without prompting for alternatives\r\n   */\r\n  showUniqueResult: boolean;\r\n  /**\r\n   * Show icons for geocoding results (if available); supported by Nominatim\r\n   */\r\n  showResultIcons: boolean;\r\n  /**\r\n   * Minimum number characters before suggest functionality is used (if available from geocoder)\r\n   */\r\n  suggestMinLength: number;\r\n  /**\r\n   * Number of milliseconds after typing stopped before suggest functionality is used (if available from geocoder)\r\n   */\r\n  suggestTimeout: number;\r\n  /**\r\n   * Initial query string for text input\r\n   */\r\n  query: string;\r\n  /**\r\n   * Minimum number of characters in search text before performing a query\r\n   */\r\n  queryMinLength: number;\r\n  /**\r\n   * Whether to mark a geocoding result on the map by default\r\n   */\r\n  defaultMarkGeocode: boolean;\r\n}\r\n\r\n\r\n/**\r\n * Leaflet mixins https://leafletjs.com/reference-1.7.1.html#class-includes\r\n * for TypeScript https://www.typescriptlang.org/docs/handbook/mixins.html\r\n * @internal\r\n */\r\nclass EventedControl {\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  constructor(...args: any[]) {\r\n    // empty\r\n  }\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\ninterface EventedControl extends L.Control, L.Evented {}\r\nL.Util.extend(EventedControl.prototype, L.Control.prototype);\r\nL.Util.extend(EventedControl.prototype, L.Evented.prototype);\r\n\r\n/**\r\n * This is the geocoder control. It works like any other [Leaflet control](https://leafletjs.com/reference.html#control), and is added to the map.\r\n */\r\nexport class GeocoderControl extends EventedControl {\r\n  options: GeocoderControlOptions = {\r\n    showUniqueResult: true,\r\n    showResultIcons: false,\r\n    collapsed: true,\r\n    expand: 'touch',\r\n    position: 'topright',\r\n    placeholder: 'Search...',\r\n    errorMessage: 'Nothing found.',\r\n    iconLabel: 'Initiate a new search',\r\n    query: '',\r\n    queryMinLength: 1,\r\n    suggestMinLength: 3,\r\n    suggestTimeout: 250,\r\n    defaultMarkGeocode: true\r\n  };\r\n\r\n  private _alts: HTMLUListElement;\r\n  private _container: HTMLDivElement;\r\n  private _errorElement: HTMLDivElement;\r\n  private _form: HTMLDivElement;\r\n  private _geocodeMarker: L.Marker;\r\n  private _input: HTMLInputElement;\r\n  private _lastGeocode: string;\r\n  private _map: L.Map;\r\n  private _preventBlurCollapse: boolean;\r\n  private _requestCount = 0;\r\n  private _results: any;\r\n  private _selection: any;\r\n  private _suggestTimeout: any;\r\n\r\n  /**\r\n   * Instantiates a geocoder control (to be invoked using `new`)\r\n   * @param options the options\r\n   */\r\n  constructor(options?: Partial<GeocoderControlOptions>) {\r\n    super(options);\r\n    L.Util.setOptions(this, options);\r\n    if (!this.options.geocoder) {\r\n      this.options.geocoder = new Nominatim();\r\n    }\r\n  }\r\n\r\n  addThrobberClass() {\r\n    L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-throbber');\r\n  }\r\n\r\n  removeThrobberClass() {\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-throbber');\r\n  }\r\n\r\n  /**\r\n   * Returns the container DOM element for the control and add listeners on relevant map events.\r\n   * @param map the map instance\r\n   * @see https://leafletjs.com/reference.html#control-onadd\r\n   */\r\n  onAdd(map: L.Map) {\r\n    const className = 'leaflet-control-geocoder';\r\n    const container = L.DomUtil.create('div', className + ' leaflet-bar') as HTMLDivElement;\r\n    const icon = L.DomUtil.create('button', className + '-icon', container) as HTMLButtonElement;\r\n    const form = (this._form = L.DomUtil.create(\r\n      'div',\r\n      className + '-form',\r\n      container\r\n    ) as HTMLDivElement);\r\n\r\n    this._map = map;\r\n    this._container = container;\r\n\r\n    icon.innerHTML = '&nbsp;';\r\n    icon.type = 'button';\r\n    icon.setAttribute('aria-label', this.options.iconLabel);\r\n\r\n    const input = (this._input = L.DomUtil.create('input', '', form) as HTMLInputElement);\r\n    input.type = 'text';\r\n    input.value = this.options.query;\r\n    input.placeholder = this.options.placeholder;\r\n    L.DomEvent.disableClickPropagation(input);\r\n\r\n    this._errorElement = L.DomUtil.create(\r\n      'div',\r\n      className + '-form-no-error',\r\n      container\r\n    ) as HTMLDivElement;\r\n    this._errorElement.innerHTML = this.options.errorMessage;\r\n\r\n    this._alts = L.DomUtil.create(\r\n      'ul',\r\n      className + '-alternatives leaflet-control-geocoder-alternatives-minimized',\r\n      container\r\n    ) as HTMLUListElement;\r\n    L.DomEvent.disableClickPropagation(this._alts);\r\n\r\n    L.DomEvent.addListener(input, 'keydown', this._keydown, this);\r\n    if (this.options.geocoder.suggest) {\r\n      L.DomEvent.addListener(input, 'input', this._change, this);\r\n    }\r\n    L.DomEvent.addListener(input, 'blur', () => {\r\n      if (this.options.collapsed && !this._preventBlurCollapse) {\r\n        this._collapse();\r\n      }\r\n      this._preventBlurCollapse = false;\r\n    });\r\n\r\n    if (this.options.collapsed) {\r\n      if (this.options.expand === 'click') {\r\n        L.DomEvent.addListener(container, 'click', (e: Event) => {\r\n          if ((e as MouseEvent).button === 0 && (e as MouseEvent).detail !== 2) {\r\n            this._toggle();\r\n          }\r\n        });\r\n      } else if (this.options.expand === 'touch') {\r\n        L.DomEvent.addListener(\r\n          container,\r\n          L.Browser.touch ? 'touchstart mousedown' : 'mousedown',\r\n          (e: Event) => {\r\n            this._toggle();\r\n            e.preventDefault(); // mobile: clicking focuses the icon, so UI expands and immediately collapses\r\n            e.stopPropagation();\r\n          },\r\n          this\r\n        );\r\n      } else {\r\n        L.DomEvent.addListener(container, 'mouseover', this._expand, this);\r\n        L.DomEvent.addListener(container, 'mouseout', this._collapse, this);\r\n        this._map.on('movestart', this._collapse, this);\r\n      }\r\n    } else {\r\n      this._expand();\r\n      if (L.Browser.touch) {\r\n        L.DomEvent.addListener(container, 'touchstart', () => this._geocode());\r\n      } else {\r\n        L.DomEvent.addListener(container, 'click', () => this._geocode());\r\n      }\r\n    }\r\n\r\n    if (this.options.defaultMarkGeocode) {\r\n      this.on('markgeocode', this.markGeocode as any, this);\r\n    }\r\n\r\n    this.on('startgeocode', this.addThrobberClass, this);\r\n    this.on('finishgeocode', this.removeThrobberClass, this);\r\n    this.on('startsuggest', this.addThrobberClass, this);\r\n    this.on('finishsuggest', this.removeThrobberClass, this);\r\n\r\n    L.DomEvent.disableClickPropagation(container);\r\n\r\n    return container;\r\n  }\r\n\r\n  /**\r\n   * Sets the query string on the text input\r\n   * @param string the query string\r\n   */\r\n  setQuery(string: string): this {\r\n    this._input.value = string;\r\n    return this;\r\n  }\r\n\r\n  private _geocodeResult(results: GeocodingResult[], suggest: boolean) {\r\n    if (!suggest && this.options.showUniqueResult && results.length === 1) {\r\n      this._geocodeResultSelected(results[0]);\r\n    } else if (results.length > 0) {\r\n      this._alts.innerHTML = '';\r\n      this._results = results;\r\n      L.DomUtil.removeClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\r\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-open');\r\n      for (let i = 0; i < results.length; i++) {\r\n        this._alts.appendChild(this._createAlt(results[i], i));\r\n      }\r\n    } else {\r\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-error');\r\n      L.DomUtil.addClass(this._errorElement, 'leaflet-control-geocoder-error');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Marks a geocoding result on the map\r\n   * @param result the geocoding result\r\n   */\r\n  markGeocode(result: GeocodingResult) {\r\n    result = (result as any).geocode || result;\r\n\r\n    this._map.fitBounds(result.bbox);\r\n\r\n    if (this._geocodeMarker) {\r\n      this._map.removeLayer(this._geocodeMarker);\r\n    }\r\n\r\n    this._geocodeMarker = new L.Marker(result.center)\r\n      .bindPopup(result.html || result.name)\r\n      .addTo(this._map)\r\n      .openPopup();\r\n\r\n    return this;\r\n  }\r\n\r\n  private _geocode(suggest?: boolean) {\r\n    const value = this._input.value;\r\n    if (!suggest && value.length < this.options.queryMinLength) {\r\n      return;\r\n    }\r\n\r\n    const requestCount = ++this._requestCount;\r\n    const cb = (results: GeocodingResult[]) => {\r\n      if (requestCount === this._requestCount) {\r\n        this.fire(suggest ? 'finishsuggest' : 'finishgeocode', { input: value, results });\r\n        this._geocodeResult(results, suggest);\r\n      }\r\n    };\r\n\r\n    this._lastGeocode = value;\r\n    if (!suggest) {\r\n      this._clearResults();\r\n    }\r\n\r\n    this.fire(suggest ? 'startsuggest' : 'startgeocode', { input: value });\r\n    if (suggest) {\r\n      this.options.geocoder.suggest(value, cb);\r\n    } else {\r\n      this.options.geocoder.geocode(value, cb);\r\n    }\r\n  }\r\n\r\n  private _geocodeResultSelected(result: GeocodingResult) {\r\n    this.fire('markgeocode', { geocode: result });\r\n  }\r\n\r\n  private _toggle() {\r\n    if (L.DomUtil.hasClass(this._container, 'leaflet-control-geocoder-expanded')) {\r\n      this._collapse();\r\n    } else {\r\n      this._expand();\r\n    }\r\n  }\r\n\r\n  private _expand() {\r\n    L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-expanded');\r\n    this._input.select();\r\n    this.fire('expand');\r\n  }\r\n\r\n  private _collapse() {\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-expanded');\r\n    L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\r\n    L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\r\n    this._input.blur(); // mobile: keyboard shouldn't stay expanded\r\n    this.fire('collapse');\r\n  }\r\n\r\n  private _clearResults() {\r\n    L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\r\n    this._selection = null;\r\n    L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\r\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\r\n  }\r\n\r\n  private _createAlt(result: GeocodingResult, index: number) {\r\n    const li = L.DomUtil.create('li', ''),\r\n      a = L.DomUtil.create('a', '', li),\r\n      icon =\r\n        this.options.showResultIcons && result.icon\r\n          ? (L.DomUtil.create('img', '', a) as HTMLImageElement)\r\n          : null,\r\n      text = result.html ? undefined : document.createTextNode(result.name),\r\n      mouseDownHandler = (e: Event) => {\r\n        // In some browsers, a click will fire on the map if the control is\r\n        // collapsed directly after mousedown. To work around this, we\r\n        // wait until the click is completed, and _then_ collapse the\r\n        // control. Messy, but this is the workaround I could come up with\r\n        // for #142.\r\n        this._preventBlurCollapse = true;\r\n        L.DomEvent.stop(e);\r\n        this._geocodeResultSelected(result);\r\n        L.DomEvent.on(li, 'click touchend', () => {\r\n          if (this.options.collapsed) {\r\n            this._collapse();\r\n          } else {\r\n            this._clearResults();\r\n          }\r\n        });\r\n      };\r\n\r\n    if (icon) {\r\n      icon.src = result.icon;\r\n    }\r\n\r\n    li.setAttribute('data-result-index', String(index));\r\n\r\n    if (result.html) {\r\n      a.innerHTML = a.innerHTML + result.html;\r\n    } else if (text) {\r\n      a.appendChild(text);\r\n    }\r\n\r\n    // Use mousedown and not click, since click will fire _after_ blur,\r\n    // causing the control to have collapsed and removed the items\r\n    // before the click can fire.\r\n    L.DomEvent.addListener(li, 'mousedown touchstart', mouseDownHandler, this);\r\n\r\n    return li;\r\n  }\r\n\r\n  private _keydown(e: KeyboardEvent) {\r\n    const select = (dir: number) => {\r\n      if (this._selection) {\r\n        L.DomUtil.removeClass(this._selection, 'leaflet-control-geocoder-selected');\r\n        this._selection = this._selection[dir > 0 ? 'nextSibling' : 'previousSibling'];\r\n      }\r\n      if (!this._selection) {\r\n        this._selection = this._alts[dir > 0 ? 'firstChild' : 'lastChild'];\r\n      }\r\n\r\n      if (this._selection) {\r\n        L.DomUtil.addClass(this._selection, 'leaflet-control-geocoder-selected');\r\n      }\r\n    };\r\n\r\n    switch (e.keyCode) {\r\n      // Escape\r\n      case 27:\r\n        if (this.options.collapsed) {\r\n          this._collapse();\r\n        } else {\r\n          this._clearResults();\r\n        }\r\n        break;\r\n      // Up\r\n      case 38:\r\n        select(-1);\r\n        break;\r\n      // Up\r\n      case 40:\r\n        select(1);\r\n        break;\r\n      // Enter\r\n      case 13:\r\n        if (this._selection) {\r\n          const index = parseInt(this._selection.getAttribute('data-result-index'), 10);\r\n          this._geocodeResultSelected(this._results[index]);\r\n          this._clearResults();\r\n        } else {\r\n          this._geocode();\r\n        }\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n\r\n    L.DomEvent.preventDefault(e);\r\n  }\r\n\r\n  private _change() {\r\n    const v = this._input.value;\r\n    if (v !== this._lastGeocode) {\r\n      clearTimeout(this._suggestTimeout);\r\n      if (v.length >= this.options.suggestMinLength) {\r\n        this._suggestTimeout = setTimeout(() => this._geocode(true), this.options.suggestTimeout);\r\n      } else {\r\n        this._clearResults();\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link GeocoderControl}\r\n * @param options the options\r\n */\r\nexport function geocoder(options?: Partial<GeocoderControlOptions>) {\r\n  return new GeocoderControl(options);\r\n}\r\n","/* @preserve\r\n * Leaflet Control Geocoder\r\n * https://github.com/perliedman/leaflet-control-geocoder\r\n *\r\n * Copyright (c) 2012 sa3m (https://github.com/sa3m)\r\n * Copyright (c) 2018 Per Liedman\r\n * All rights reserved.\r\n */\r\nimport * as L from 'leaflet';\r\nimport { GeocoderControl as Geocoder, geocoder } from './control';\r\nimport * as geocoders from './geocoders/index';\r\n\r\nL.Util.extend(Geocoder, geocoders);\r\nexport default Geocoder;\r\n\r\nL.Util.extend(L.Control, {\r\n  Geocoder: Geocoder,\r\n  geocoder: geocoder\r\n});\r\n"],"names":["geocodingParams","options","params","L","extend","geocodingQueryParams","reverseParams","reverseQueryParams","lastCallbackId","badChars","possible","escape","&","<",">","\"","'","`","escapeChar","chr","jsonp","url","callback","context","jsonpParam","callbackId","window","bind","script","document","createElement","type","src","getParamString","id","getElementsByTagName","appendChild","getJSON","xmlHttp","XMLHttpRequest","onreadystatechange","readyState","message","status","response","JSON","parse","e","open","responseType","setRequestHeader","send","obj","existingUrl","uppercase","i","key","encodeURIComponent","toUpperCase","value","Array","isArray","j","length","push","String","indexOf","join","ArcGis","this","serviceUrl","apiKey","setOptions","geocode","query","cb","token","SingleLine","outFields","forStorage","maxLocations","f","data","results","candidates","loc","latLng","location","y","x","latLngBounds","extent","ymax","xmax","ymin","xmin","name","address","bbox","center","call","suggest","reverse","scale","lng","lat","distance","result","error","Match_addr","Bing","resourceSets","resources","resource","point","coordinates","Google","geometry","viewport","northeast","southwest","formatted_address","properties","address_components","latlng","HERE","app_id","app_code","Error","searchtext","gen","jsonattributes","prox","reverseGeocodeProxRadius","mode","view","displayPosition","latitude","longitude","mapView","topLeft","bottomRight","label","HEREv2","q","at","limit","items","item","position","south","west","north","east","parseLatLng","match","test","LatLng","next","undefined","sizeInMeters","toBounds","Mapbox","_getProperties","text","split","short_code","access_token","proximity","features","slice","place_name","_this","_this2","MapQuest","decodeURIComponent","_formatName","filter","s","outFormat","locations","street","adminArea4","adminArea3","adminArea1","outputFormat","Neutrino","userId","found","Nominatim","htmlTemplate","r","str","parts","road","building","city","town","village","hamlet","state","country","replace","string","format","addressdetails","boundingbox","icon","display_name","html","lon","zoom","Math","round","log","OpenLocationCode","decoded","decode","latitudeCenter","longitudeCenter","latitudeLo","longitudeLo","latitudeHi","longitudeHi","console","warn","encode","codeLength","OpenCage","annotations","bounds","formatted","Pelias","api_key","_parseResults","geocoding","timestamp","_lastSuggest","point.lat","point.lon","_this3","bboxname","pointToLayer","feature","onEachFeature","layer","getBounds","getCenter","getLatLng","coordsToLatLng","pelias","GeocodeEarth","geocodeEarth","Mapzen","mapzen","Openrouteservice","Photon","reverseUrl","nameProperties","_decodeFeatures","c","_decodeFeatureName","map","p","v","What3Words","addr","words","coords","EventedControl","prototype","GeocoderControl","showUniqueResult","showResultIcons","collapsed","expand","placeholder","errorMessage","iconLabel","queryMinLength","suggestMinLength","suggestTimeout","defaultMarkGeocode","geocoder","addThrobberClass","addClass","_container","removeThrobberClass","removeClass","onAdd","className","container","create","form","_form","_map","innerHTML","setAttribute","input","_input","disableClickPropagation","_errorElement","_alts","addListener","_keydown","_change","_preventBlurCollapse","_collapse","button","detail","_toggle","touch","preventDefault","stopPropagation","_expand","on","_geocode","markGeocode","setQuery","_geocodeResult","_geocodeResultSelected","_results","_createAlt","fitBounds","_geocodeMarker","removeLayer","bindPopup","addTo","openPopup","requestCount","_requestCount","fire","_lastGeocode","_clearResults","hasClass","select","blur","_selection","index","li","a","createTextNode","_this4","stop","dir","_this5","keyCode","parseInt","getAttribute","clearTimeout","_suggestTimeout","setTimeout","_this6","Geocoder","geocoders"],"mappings":"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"}